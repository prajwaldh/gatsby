{"data":{"markdownRemark":{"html":"<h2 id=\"input-filters-vs-gqltype\"><a href=\"#input-filters-vs-gqltype\" aria-label=\"input filters vs gqltype permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Input Filters vs gqlType</h2>\n<p>In <a href=\"/docs/schema-gql-type\">gqlTypes</a>, we inferred a Gatsby Node’s main fields. These allow us to query a node’s children, parent and object fields. But these are only useful once a top level GraphQL Query has returned results. In order to query by those fields, we must create GraphQL objects for input filters. E.g, querying for all markdownRemark nodes that have 4 paragraphs.</p>\n<div class=\"gatsby-highlight\" data-language=\"graphql\"><pre class=\"language-graphql\"><code class=\"language-graphql\"><span class=\"token punctuation\">{</span>\n  markdownRemark<span class=\"token punctuation\">(</span><span class=\"token attr-name\">wordCount</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token attr-name\">paragraphs</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token attr-name\">eq</span><span class=\"token punctuation\">:</span> <span class=\"token number\">4</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    html\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>The arguments (<code class=\"language-text\">wordcount: {paragraphs: {eq: 4}}</code>) to the query are known as Input filters. In graphql-js, they are the <a href=\"https://graphql.org/graphql-js/type/#graphqlinputobjecttype\">GraphQLInputObjectType</a>. This section covers how these Input filters are inferred.</p>\n<h3 id=\"inferring-input-filters-from-example-node-values\"><a href=\"#inferring-input-filters-from-example-node-values\" aria-label=\"inferring input filters from example node values permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Inferring input filters from example node values</h3>\n<p>The first step is to generate an input field for each type of field on the redux nodes. For example, we might want to query markdown nodes by their front matter author:</p>\n<div class=\"gatsby-highlight\" data-language=\"graphql\"><pre class=\"language-graphql\"><code class=\"language-graphql\"><span class=\"token punctuation\">{</span>\n  markdownRemark<span class=\"token punctuation\">(</span><span class=\"token attr-name\">frontmatter</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token attr-name\">author</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token attr-name\">eq</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"F. Scott Fitzgerald\"</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    id\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>This step is handled by <a href=\"https://github.com/gatsbyjs/gatsby/blob/master/packages/gatsby/src/schema/infer-graphql-input-fields.js#L235\">inferInputObjectStrctureFromNodes</a>. First, we generate an example Value (see <a href=\"/docs/schema-gql-type#gqltype-creation\">gqlTypes</a>). For each field on the example value (e.g <code class=\"language-text\">author</code>), we create a <a href=\"https://graphql.org/graphql-js/type/#graphqlinputobjecttype\">GraphQLInputObjectType</a> with an appropriate name. The fields for Input Objects are predicates that depend on the value’s <code class=\"language-text\">typeof</code> result. E.g for a String, we need to be able to query by <code class=\"language-text\">eq</code>, <code class=\"language-text\">regex</code> etc. If the value is an object itself, then we recurse, building its fields as above.</p>\n<p>If the key is a foreign key reference (ends in <code class=\"language-text\">___NODE</code>), then we find the field’s linked Type first, and progress as above (for more on how foreign keys are implemented, see <a href=\"/docs/schema-gql-type#foreign-key-reference-___node\">gqlType</a>). After this step, we will end up with an Input Object type such as .</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token punctuation\">{</span>\n  <span class=\"token template-string\"><span class=\"token string\">`MarkdownRemarkFrontmatterAuthor`</span></span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    name<span class=\"token punctuation\">:</span> <span class=\"token template-string\"><span class=\"token string\">`MarkdownRemarkFrontmatterAuthorInputObject`</span></span><span class=\"token punctuation\">,</span>\n    fields<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token template-string\"><span class=\"token string\">`MarkdownRemarkFrontmatterAuthorName`</span></span> <span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        name<span class=\"token punctuation\">:</span> <span class=\"token template-string\"><span class=\"token string\">`MarkdownRemarkFrontmatterAuthorNameQueryString`</span></span><span class=\"token punctuation\">,</span>\n        fields<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n          eq<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> type<span class=\"token punctuation\">:</span> GraphQLString <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n          ne<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> type<span class=\"token punctuation\">:</span> GraphQLString <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n          regex<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> type<span class=\"token punctuation\">:</span> GraphQLString <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n          glob<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> type<span class=\"token punctuation\">:</span> GraphQLString <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n          <span class=\"token keyword\">in</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> type<span class=\"token punctuation\">:</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">GraphQLList</span><span class=\"token punctuation\">(</span>GraphQLString<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"inferring-input-filters-from-plugin-fields\"><a href=\"#inferring-input-filters-from-plugin-fields\" aria-label=\"inferring input filters from plugin fields permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Inferring input filters from plugin fields</h3>\n<p>Plugins themselves have the opportunity to create custom fields that apply to ALL nodes of a particular type, as opposed to having to explicitly add the field on every node creation. An example would be <code class=\"language-text\">markdownRemark</code> which adds a <code class=\"language-text\">wordcount</code> field to each node automatically. This section deals with the generation of input filters so that we can query by these fields as well. E.g:</p>\n<div class=\"gatsby-highlight\" data-language=\"graphql\"><pre class=\"language-graphql\"><code class=\"language-graphql\"><span class=\"token punctuation\">{</span>\n  markdownRemark<span class=\"token punctuation\">(</span><span class=\"token attr-name\">wordCount</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token attr-name\">paragraphs</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token attr-name\">eq</span><span class=\"token punctuation\">:</span> <span class=\"token number\">4</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    html\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Plugins add custom fields by implementing the <a href=\"/docs/node-apis/#setFieldsOnGraphQLNodeType\">setFieldsOnGraphQLNodeType</a> API. They must return a full GraphQLObjectType, complete with <code class=\"language-text\">resolve</code> function. Once this API has been run, the fields are passed to <a href=\"https://github.com/gatsbyjs/gatsby/blob/master/packages/gatsby/src/schema/infer-graphql-input-fields-from-fields.js#L195\">inferInputObjectStructureFromFields</a>, which will generate input filters for the new fields. The result would look something like:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token punctuation\">{</span> <span class=\"token comment\">//GraphQLInputObjectType</span>\n  name<span class=\"token punctuation\">:</span> <span class=\"token template-string\"><span class=\"token string\">`WordCountwordcountInputObject`</span></span><span class=\"token punctuation\">,</span>\n  fields<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token template-string\"><span class=\"token string\">`paragraphs`</span></span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n      type<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// GraphQLInputObjectType</span>\n        name<span class=\"token punctuation\">:</span> <span class=\"token template-string\"><span class=\"token string\">`WordCountParagraphsQueryInt`</span></span><span class=\"token punctuation\">,</span>\n        fields<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n          eq<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> type<span class=\"token punctuation\">:</span> GraphQLInt <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n          ne<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> type<span class=\"token punctuation\">:</span> GraphQLInt <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n          gt<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> type<span class=\"token punctuation\">:</span> GraphQLInt <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n          gte<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> type<span class=\"token punctuation\">:</span> GraphQLInt <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n          lt<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> type<span class=\"token punctuation\">:</span> GraphQLInt <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n          lte<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> type<span class=\"token punctuation\">:</span> GraphQLInt <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n          <span class=\"token keyword\">in</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> type<span class=\"token punctuation\">:</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">GraphQLList</span><span class=\"token punctuation\">(</span>GraphQLInt<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>As usual, the input filter fields (<code class=\"language-text\">eq</code>, <code class=\"language-text\">lt</code>, <code class=\"language-text\">gt</code>, etc) are based on the type of the field (<code class=\"language-text\">Int</code> in this case), which is defined by the plugin.</p>\n<h3 id=\"merged-result\"><a href=\"#merged-result\" aria-label=\"merged result permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Merged result</h3>\n<p>Now that we’ve generated input fields from the redux nodes and from custom plugin fields, we merge them together. E.g</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token punctuation\">{</span>\n\n  <span class=\"token comment\">// from infer input fields from object</span>\n  <span class=\"token template-string\"><span class=\"token string\">`MarkdownRemarkAuthor`</span></span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    name<span class=\"token punctuation\">:</span> <span class=\"token template-string\"><span class=\"token string\">`MarkdownRemarkAuthorInputObject`</span></span><span class=\"token punctuation\">,</span>\n    fields<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token template-string\"><span class=\"token string\">`MarkdownRemarkAuthorName`</span></span> <span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        name<span class=\"token punctuation\">:</span> <span class=\"token template-string\"><span class=\"token string\">`MarkdownRemarkAuthorNameQueryString`</span></span><span class=\"token punctuation\">,</span>\n        fields<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n          eq<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> type<span class=\"token punctuation\">:</span> GraphQLString <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n          ne<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> type<span class=\"token punctuation\">:</span> GraphQLString <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n          regex<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> type<span class=\"token punctuation\">:</span> GraphQLString <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n          glob<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> type<span class=\"token punctuation\">:</span> GraphQLString <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n          <span class=\"token keyword\">in</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> type<span class=\"token punctuation\">:</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">GraphQLList</span><span class=\"token punctuation\">(</span>GraphQLString<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token comment\">// From infer input fields from fields</span>\n  <span class=\"token template-string\"><span class=\"token string\">`wordCount`</span></span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">//GraphQLInputObjectType</span>\n    name<span class=\"token punctuation\">:</span> <span class=\"token template-string\"><span class=\"token string\">`WordCountwordcountInputObject`</span></span><span class=\"token punctuation\">,</span>\n    fields<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token template-string\"><span class=\"token string\">`paragraphs`</span></span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        type<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// GraphQLInputObjectType</span>\n          name<span class=\"token punctuation\">:</span> <span class=\"token template-string\"><span class=\"token string\">`WordCountParagraphsQueryInt`</span></span><span class=\"token punctuation\">,</span>\n          fields<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n            eq<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> type<span class=\"token punctuation\">:</span> GraphQLInt <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            ne<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> type<span class=\"token punctuation\">:</span> GraphQLInt <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            gt<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> type<span class=\"token punctuation\">:</span> GraphQLInt <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            gte<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> type<span class=\"token punctuation\">:</span> GraphQLInt <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            lt<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> type<span class=\"token punctuation\">:</span> GraphQLInt <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            lte<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> type<span class=\"token punctuation\">:</span> GraphQLInt <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token keyword\">in</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> type<span class=\"token punctuation\">:</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">GraphQLList</span><span class=\"token punctuation\">(</span>GraphQLInt<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","excerpt":"Input Filters vs gqlType In  gqlTypes , we inferred a Gatsby Node’s main fields. These allow us to query a node’s children, parent and…","timeToRead":4,"fields":{"slug":"/docs/schema-input-gql/","anchor":"schema-input-gql"},"frontmatter":{"title":"Inferring Input Filters","overview":null,"issue":null},"parent":{"__typename":"File","relativePath":"docs/schema-input-gql.md"}}},"pageContext":{"slug":"/docs/schema-input-gql/"}}