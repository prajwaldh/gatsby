{"expireTime":9007200804686247000,"key":"transformer-remark-markdown-ast-35311436ad07a0f1ac8ed3257f98f97d-gatsby-remark-graphvizgatsby-remark-code-titlesgatsby-remark-imagesgatsby-remark-responsive-iframegatsby-remark-autolink-headersgatsby-remark-prismjsgatsby-remark-copy-linked-filesgatsby-remark-smartypants-","val":{"type":"root","children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"https://codeclimate.com/github/andrew-codes/gatsby-plugin-elasticlunr-search/maintainability","children":[{"type":"image","title":null,"url":"https://api.codeclimate.com/v1/badges/124348de2ee6850d682f/maintainability","alt":"Maintainability","position":{"start":{"line":1,"column":2,"offset":1},"end":{"line":1,"column":96,"offset":95},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":1,"column":191,"offset":190},"indent":[]}},{"type":"text","value":"\n","position":{"start":{"line":1,"column":191,"offset":190},"end":{"line":2,"column":1,"offset":191},"indent":[1]}},{"type":"link","title":null,"url":"https://www.codacy.com/app/andrew-codes/gatsby-plugin-elasticlunr-search?utm_source=github.com&utm_medium=referral&utm_content=andrew-codes/gatsby-plugin-elasticlunr-search&utm_campaign=Badge_Grade","children":[{"type":"image","title":null,"url":"https://api.codacy.com/project/badge/Grade/7230ae7191f44a9489834553760310c2","alt":"Codacy Badge","position":{"start":{"line":2,"column":2,"offset":192},"end":{"line":2,"column":94,"offset":284},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":191},"end":{"line":2,"column":294,"offset":484},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":2,"column":294,"offset":484},"indent":[1]}},{"type":"heading","depth":1,"children":[{"type":"link","url":"#search-plugin-for-gatsby","title":null,"data":{"hProperties":{"aria-label":"search plugin for gatsby permalink","class":"anchor"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"Search Plugin for Gatsby","position":{"start":{"line":4,"column":3,"offset":488},"end":{"line":4,"column":27,"offset":512},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":486},"end":{"line":4,"column":27,"offset":512},"indent":[]},"data":{"id":"search-plugin-for-gatsby","htmlAttributes":{"id":"search-plugin-for-gatsby"},"hProperties":{"id":"search-plugin-for-gatsby"}}},{"type":"paragraph","children":[{"type":"text","value":"This plugin enables search integration via elastic lunr. Content is indexed and then made available via graphql to rehydrate into an ","position":{"start":{"line":6,"column":1,"offset":514},"end":{"line":6,"column":134,"offset":647},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">elasticlunr</code>","position":{"start":{"line":6,"column":134,"offset":647},"end":{"line":6,"column":147,"offset":660},"indent":[]}},{"type":"text","value":" index. From there, queries can be made against this index to retrieve pages by their ID.","position":{"start":{"line":6,"column":147,"offset":660},"end":{"line":6,"column":236,"offset":749},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":514},"end":{"line":6,"column":236,"offset":749},"indent":[]}},{"type":"heading","depth":1,"children":[{"type":"link","url":"#getting-started","title":null,"data":{"hProperties":{"aria-label":"getting started permalink","class":"anchor"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"Getting Started","position":{"start":{"line":8,"column":3,"offset":753},"end":{"line":8,"column":18,"offset":768},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":751},"end":{"line":8,"column":18,"offset":768},"indent":[]},"data":{"id":"getting-started","htmlAttributes":{"id":"getting-started"},"hProperties":{"id":"getting-started"}}},{"type":"paragraph","children":[{"type":"text","value":"Install the plugin via ","position":{"start":{"line":10,"column":1,"offset":770},"end":{"line":10,"column":24,"offset":793},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">npm install -D @andrew-codes/gatsby-plugin-elasticlunr-search</code>","position":{"start":{"line":10,"column":24,"offset":793},"end":{"line":10,"column":87,"offset":856},"indent":[]}},{"type":"text","value":". See the ","position":{"start":{"line":10,"column":87,"offset":856},"end":{"line":10,"column":97,"offset":866},"indent":[]}},{"type":"link","title":null,"url":"https://github.com/andrew-codes/gatsby-plugin-elasticlunr-search-demo","children":[{"type":"text","value":"demo site repo","position":{"start":{"line":10,"column":98,"offset":867},"end":{"line":10,"column":112,"offset":881},"indent":[]}}],"position":{"start":{"line":10,"column":97,"offset":866},"end":{"line":10,"column":184,"offset":953},"indent":[]}},{"type":"text","value":" for more specific implementation details.","position":{"start":{"line":10,"column":184,"offset":953},"end":{"line":10,"column":226,"offset":995},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":770},"end":{"line":10,"column":226,"offset":995},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Next, update your ","position":{"start":{"line":12,"column":1,"offset":997},"end":{"line":12,"column":19,"offset":1015},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">gatsby-config.js</code>","position":{"start":{"line":12,"column":19,"offset":1015},"end":{"line":12,"column":37,"offset":1033},"indent":[]}},{"type":"text","value":" file to utilize the plugin.","position":{"start":{"line":12,"column":37,"offset":1033},"end":{"line":12,"column":65,"offset":1061},"indent":[]}}],"position":{"start":{"line":12,"column":1,"offset":997},"end":{"line":12,"column":65,"offset":1061},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"link","url":"#usage","title":null,"data":{"hProperties":{"aria-label":"usage permalink","class":"anchor"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"Usage","position":{"start":{"line":14,"column":4,"offset":1066},"end":{"line":14,"column":9,"offset":1071},"indent":[]}}],"position":{"start":{"line":14,"column":1,"offset":1063},"end":{"line":14,"column":9,"offset":1071},"indent":[]},"data":{"id":"usage","htmlAttributes":{"id":"usage"},"hProperties":{"id":"usage"}}},{"type":"paragraph","children":[{"type":"text","value":"In order to add documents to the search index, you will need to inform the plugin which types of documents are relevant to your search needs. If you are unsure of the exact type, open gatsbyâ€™s graphiql endpoint via a web browser of the graphiql app. Search the docs explorer for you schema, then perform a query on it like so:","position":{"start":{"line":16,"column":1,"offset":1073},"end":{"line":16,"column":327,"offset":1399},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":1073},"end":{"line":16,"column":327,"offset":1399},"indent":[]}},{"type":"html","lang":null,"value":"<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">query GetTypeQuery {\n    wordpress__POST {\n        internal {\n            type\n        }\n    }\n}</code></pre></div>","position":{"start":{"line":18,"column":1,"offset":1401},"end":{"line":26,"column":4,"offset":1505},"indent":[1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"The output of type is what you will use in your resolver as demonstrated below.","position":{"start":{"line":28,"column":1,"offset":1507},"end":{"line":28,"column":80,"offset":1586},"indent":[]}}],"position":{"start":{"line":28,"column":1,"offset":1507},"end":{"line":28,"column":80,"offset":1586},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"link","url":"#basic-example","title":null,"data":{"hProperties":{"aria-label":"basic example permalink","class":"anchor"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"Basic Example","position":{"start":{"line":30,"column":5,"offset":1592},"end":{"line":30,"column":18,"offset":1605},"indent":[]}}],"position":{"start":{"line":30,"column":1,"offset":1588},"end":{"line":30,"column":18,"offset":1605},"indent":[]},"data":{"id":"basic-example","htmlAttributes":{"id":"basic-example"},"hProperties":{"id":"basic-example"}}},{"type":"html","lang":"javascript","value":"<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// gatsby-config.js</span>\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    plugins<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">{</span>\n            resolve<span class=\"token punctuation\">:</span> <span class=\"token template-string\"><span class=\"token string\">`@andrew-codes/gatsby-plugin-elasticlunr-search`</span></span><span class=\"token punctuation\">,</span>\n            options<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token comment\">// Fields to index</span>\n                fields<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'title'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'keywords'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                <span class=\"token comment\">// How to resolve each field's value for a supported node type</span>\n                resolvers<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token comment\">// For any node of type MarkdownRemark, list how to resolve the fields' values</span>\n                    MarkdownRemark<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                        title<span class=\"token punctuation\">:</span> node <span class=\"token operator\">=></span> node<span class=\"token punctuation\">.</span>frontmatter<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">,</span>\n                        keywords<span class=\"token punctuation\">:</span> node <span class=\"token operator\">=></span> node<span class=\"token punctuation\">.</span>frontmatter<span class=\"token punctuation\">.</span>keywords\n                    <span class=\"token punctuation\">}</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>","position":{"start":{"line":32,"column":1,"offset":1607},"end":{"line":53,"column":4,"offset":2313},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"link","url":"#resolve-relational-data","title":null,"data":{"hProperties":{"aria-label":"resolve relational data permalink","class":"anchor"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"Resolve relational Data","position":{"start":{"line":55,"column":5,"offset":2319},"end":{"line":55,"column":28,"offset":2342},"indent":[]}}],"position":{"start":{"line":55,"column":1,"offset":2315},"end":{"line":55,"column":28,"offset":2342},"indent":[]},"data":{"id":"resolve-relational-data","htmlAttributes":{"id":"resolve-relational-data"},"hProperties":{"id":"resolve-relational-data"}}},{"type":"paragraph","children":[{"type":"text","value":"Some data sources store necesary fields in foreign nodes. One example of this is WordPress. It store categories, tags, authors, and posts in separate DB tables/rows. Gatsby handles stitching these together for you. However, at this stage of the build, it only has the ID of the node it relates to. In order to add the data from the related node, we will need to resolve it ourselves. Below is an example of adding the author name to the document in the search index for a wordpress poet.","position":{"start":{"line":57,"column":1,"offset":2344},"end":{"line":57,"column":488,"offset":2831},"indent":[]}}],"position":{"start":{"line":57,"column":1,"offset":2344},"end":{"line":57,"column":488,"offset":2831},"indent":[]}},{"type":"html","lang":"javascript","value":"<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// gatsby-config.js</span>\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    plugins<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">{</span>\n            resolve<span class=\"token punctuation\">:</span> <span class=\"token template-string\"><span class=\"token string\">`@andrew-codes/gatsby-plugin-elasticlunr-search`</span></span><span class=\"token punctuation\">,</span>\n            options<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token comment\">// Fields to index</span>\n                fields<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'title'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'author'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                <span class=\"token comment\">// How to resolve each field's value for a supported node type</span>\n                resolvers<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token comment\">// For any node of type wordpress__POST, list how to resolve the fields' values</span>\n                    wordpress__POST<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                        title<span class=\"token punctuation\">:</span> node <span class=\"token operator\">=></span> node<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">,</span>\n                        author<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">,</span> getNode<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n                            <span class=\"token function\">getNode</span><span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">.</span>author___NODE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>name\n                    <span class=\"token punctuation\">}</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>","position":{"start":{"line":59,"column":1,"offset":2833},"end":{"line":81,"column":4,"offset":3571},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"link","url":"#filter-nodes-that-are-added-to-the-index","title":null,"data":{"hProperties":{"aria-label":"filter nodes that are added to the index permalink","class":"anchor"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"Filter nodes that are added to the index","position":{"start":{"line":83,"column":5,"offset":3577},"end":{"line":83,"column":45,"offset":3617},"indent":[]}}],"position":{"start":{"line":83,"column":1,"offset":3573},"end":{"line":83,"column":45,"offset":3617},"indent":[]},"data":{"id":"filter-nodes-that-are-added-to-the-index","htmlAttributes":{"id":"filter-nodes-that-are-added-to-the-index"},"hProperties":{"id":"filter-nodes-that-are-added-to-the-index"}}},{"type":"paragraph","children":[{"type":"text","value":"gatsby-plugin-elasticlunr-search allows you to filter the nodes that go in to the index to avoid unnecessary memory usage.","position":{"start":{"line":85,"column":1,"offset":3619},"end":{"line":85,"column":123,"offset":3741},"indent":[]}}],"position":{"start":{"line":85,"column":1,"offset":3619},"end":{"line":85,"column":123,"offset":3741},"indent":[]}},{"type":"html","lang":"javascript","value":"<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// gatsby-config.js</span>\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    plugins<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">{</span>\n            resolve<span class=\"token punctuation\">:</span> <span class=\"token template-string\"><span class=\"token string\">`@andrew-codes/gatsby-plugin-elasticlunr-search`</span></span><span class=\"token punctuation\">,</span>\n            options<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token comment\">// Fields to index</span>\n                fields<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'title'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'keywords'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                <span class=\"token comment\">// How to resolve each field's value for a supported node type</span>\n                resolvers<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token comment\">// For any node of type MarkdownRemark, list how to resolve the fields' values</span>\n                    MarkdownRemark<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                        title<span class=\"token punctuation\">:</span> node <span class=\"token operator\">=></span> node<span class=\"token punctuation\">.</span>frontmatter<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">,</span>\n                        keywords<span class=\"token punctuation\">:</span> node <span class=\"token operator\">=></span> node<span class=\"token punctuation\">.</span>frontmatter<span class=\"token punctuation\">.</span>keywords\n                    <span class=\"token punctuation\">}</span>\n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                filter<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">,</span> getNode<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> node<span class=\"token punctuation\">.</span>post_type <span class=\"token operator\">!==</span> <span class=\"token string\">'page'</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>","position":{"start":{"line":87,"column":1,"offset":3743},"end":{"line":109,"column":4,"offset":4519},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"link","url":"#filter-nodes-that-are-added-to-the-index-based-on-props-of-another-node","title":null,"data":{"hProperties":{"aria-label":"filter nodes that are added to the index based on props of another node permalink","class":"anchor"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"Filter nodes that are added to the index, based on props of another node","position":{"start":{"line":111,"column":5,"offset":4525},"end":{"line":111,"column":77,"offset":4597},"indent":[]}}],"position":{"start":{"line":111,"column":1,"offset":4521},"end":{"line":111,"column":77,"offset":4597},"indent":[]},"data":{"id":"filter-nodes-that-are-added-to-the-index-based-on-props-of-another-node","htmlAttributes":{"id":"filter-nodes-that-are-added-to-the-index-based-on-props-of-another-node"},"hProperties":{"id":"filter-nodes-that-are-added-to-the-index-based-on-props-of-another-node"}}},{"type":"html","lang":"javascript","value":"<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// gatsby-config.js</span>\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    plugins<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">{</span>\n            resolve<span class=\"token punctuation\">:</span> <span class=\"token template-string\"><span class=\"token string\">`@andrew-codes/gatsby-plugin-elasticlunr-search`</span></span><span class=\"token punctuation\">,</span>\n            options<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token comment\">// Fields to index</span>\n                fields<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'title'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'keywords'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                <span class=\"token comment\">// How to resolve each field's value for a supported node type</span>\n                resolvers<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token comment\">// For any node of type MarkdownRemark, list how to resolve the fields' values</span>\n                    MarkdownRemark<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                        title<span class=\"token punctuation\">:</span> node <span class=\"token operator\">=></span> node<span class=\"token punctuation\">.</span>frontmatter<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">,</span>\n                        keywords<span class=\"token punctuation\">:</span> node <span class=\"token operator\">=></span> node<span class=\"token punctuation\">.</span>frontmatter<span class=\"token punctuation\">.</span>keywords\n                    <span class=\"token punctuation\">}</span>\n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                filter<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">,</span> getNode<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token keyword\">const</span> categoryIds <span class=\"token operator\">=</span> node<span class=\"token punctuation\">.</span>category___NODE<span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">const</span> categoryNames <span class=\"token operator\">=</span> categoryIds<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>\n                        id <span class=\"token operator\">=></span> <span class=\"token function\">getNode</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>name\n                    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n                    <span class=\"token keyword\">return</span> <span class=\"token operator\">!</span>categorynames<span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span><span class=\"token string\">'no-search'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>","position":{"start":{"line":113,"column":1,"offset":4599},"end":{"line":142,"column":4,"offset":5626},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"link","url":"#consuming-in-your-site","title":null,"data":{"hProperties":{"aria-label":"consuming in your site permalink","class":"anchor"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"Consuming in Your Site","position":{"start":{"line":144,"column":4,"offset":5631},"end":{"line":144,"column":26,"offset":5653},"indent":[]}}],"position":{"start":{"line":144,"column":1,"offset":5628},"end":{"line":144,"column":26,"offset":5653},"indent":[]},"data":{"id":"consuming-in-your-site","htmlAttributes":{"id":"consuming-in-your-site"},"hProperties":{"id":"consuming-in-your-site"}}},{"type":"paragraph","children":[{"type":"text","value":"The serialized search index will be available via graphql. Once queried, a component can create a new elastic lunr index with the value retrieved from the graphql query. Search queries can be made against the hydrated search index. The results is an array of document IDs. The index can return the full document given a document ID","position":{"start":{"line":146,"column":1,"offset":5655},"end":{"line":146,"column":332,"offset":5986},"indent":[]}}],"position":{"start":{"line":146,"column":1,"offset":5655},"end":{"line":146,"column":332,"offset":5986},"indent":[]}},{"type":"html","lang":"javascript","value":"<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> Component <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Index <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'elasticlunr'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Graphql query used to retrieve the serialized search index.</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> query <span class=\"token operator\">=</span> graphql<span class=\"token template-string\"><span class=\"token string\">`\n    query SearchIndexExampleQuery {\n        siteSearchIndex {\n            index\n        }\n    }\n`</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Search component</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Search</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Component</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n            query<span class=\"token punctuation\">:</span> <span class=\"token template-string\"><span class=\"token string\">``</span></span><span class=\"token punctuation\">,</span>\n            results<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n            <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n                <span class=\"token operator\">&lt;</span>input\n                    type<span class=\"token operator\">=</span><span class=\"token string\">\"text\"</span>\n                    value<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>query<span class=\"token punctuation\">}</span>\n                    onChange<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>search<span class=\"token punctuation\">}</span>\n                <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n                <span class=\"token operator\">&lt;</span>ul<span class=\"token operator\">></span>\n                    <span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>results<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>page <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n                        <span class=\"token operator\">&lt;</span>li<span class=\"token operator\">></span>\n                            <span class=\"token punctuation\">{</span>page<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">}</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>page<span class=\"token punctuation\">.</span>keywords<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token string\">`,`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n                        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>li<span class=\"token operator\">></span>\n                    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n                <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>ul<span class=\"token operator\">></span>\n            <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token function-variable function\">getOrCreateIndex</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>index\n            <span class=\"token operator\">?</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>index\n            <span class=\"token punctuation\">:</span> <span class=\"token comment\">// Create an elastic lunr index and hydrate with graphql query results</span>\n              Index<span class=\"token punctuation\">.</span><span class=\"token function\">load</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>siteSearchIndex<span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function-variable function\">search</span> <span class=\"token operator\">=</span> evt <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">const</span> query <span class=\"token operator\">=</span> evt<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>index <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getOrCreateIndex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n            query<span class=\"token punctuation\">,</span>\n            <span class=\"token comment\">// Query the index with search string to get an [] of IDs</span>\n            results<span class=\"token punctuation\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>index\n                <span class=\"token punctuation\">.</span><span class=\"token function\">search</span><span class=\"token punctuation\">(</span>query<span class=\"token punctuation\">)</span>\n                <span class=\"token comment\">// Map over each ID and return the full document</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> ref <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">.</span>documentStore<span class=\"token punctuation\">.</span><span class=\"token function\">getDoc</span><span class=\"token punctuation\">(</span>ref<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":148,"column":1,"offset":5988},"end":{"line":209,"column":4,"offset":7644},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":210,"column":1,"offset":7645}}}}