{"expireTime":9007200804686247000,"key":"transformer-remark-markdown-html-ast-60d5349a1307ac3631dd1b5c77605775-gatsby-remark-graphvizgatsby-remark-code-titlesgatsby-remark-imagesgatsby-remark-responsive-iframegatsby-remark-autolink-headersgatsby-remark-prismjsgatsby-remark-copy-linked-filesgatsby-remark-smartypants-","val":{"type":"root","children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://codeclimate.com/github/andrew-codes/gatsby-plugin-elasticlunr-search/maintainability"},"children":[{"type":"element","tagName":"img","properties":{"src":"https://api.codeclimate.com/v1/badges/124348de2ee6850d682f/maintainability","alt":"Maintainability"},"children":[],"position":{"start":{"line":1,"column":2,"offset":1},"end":{"line":1,"column":96,"offset":95}}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":1,"column":191,"offset":190}}},{"type":"text","value":"\n","position":{"start":{"line":1,"column":191,"offset":190},"end":{"line":2,"column":1,"offset":191}}},{"type":"element","tagName":"a","properties":{"href":"https://www.codacy.com/app/andrew-codes/gatsby-plugin-elasticlunr-search?utm_source=github.com&utm_medium=referral&utm_content=andrew-codes/gatsby-plugin-elasticlunr-search&utm_campaign=Badge_Grade"},"children":[{"type":"element","tagName":"img","properties":{"src":"https://api.codacy.com/project/badge/Grade/7230ae7191f44a9489834553760310c2","alt":"Codacy Badge"},"children":[],"position":{"start":{"line":2,"column":2,"offset":192},"end":{"line":2,"column":94,"offset":284}}}],"position":{"start":{"line":2,"column":1,"offset":191},"end":{"line":2,"column":306,"offset":496}}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":2,"column":306,"offset":496}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h1","properties":{"id":"search-plugin-for-gatsby"},"children":[{"type":"element","tagName":"a","properties":{"href":"#search-plugin-for-gatsby","aria-label":"search plugin for gatsby permalink","class":"anchor"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Search Plugin for Gatsby","position":{"start":{"line":4,"column":3,"offset":500},"end":{"line":4,"column":27,"offset":524}}}],"position":{"start":{"line":4,"column":1,"offset":498},"end":{"line":4,"column":27,"offset":524}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"This plugin enables search integration via elastic lunr. Content is indexed and then made available via graphql to rehydrate into an ","position":{"start":{"line":5,"column":1,"offset":525},"end":{"line":5,"column":134,"offset":658}}},{"type":"raw","value":"<code class=\"language-text\">elasticlunr</code>","position":{"start":{"line":5,"column":134,"offset":658},"end":{"line":5,"column":147,"offset":671}}},{"type":"text","value":" index. From there, queries can be made against this index to retrieve pages by their ID.","position":{"start":{"line":5,"column":147,"offset":671},"end":{"line":5,"column":236,"offset":760}}}],"position":{"start":{"line":5,"column":1,"offset":525},"end":{"line":5,"column":236,"offset":760}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h1","properties":{"id":"getting-started"},"children":[{"type":"element","tagName":"a","properties":{"href":"#getting-started","aria-label":"getting started permalink","class":"anchor"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Getting Started","position":{"start":{"line":7,"column":3,"offset":764},"end":{"line":7,"column":18,"offset":779}}}],"position":{"start":{"line":7,"column":1,"offset":762},"end":{"line":7,"column":18,"offset":779}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Install the plugin via ","position":{"start":{"line":9,"column":1,"offset":781},"end":{"line":9,"column":24,"offset":804}}},{"type":"raw","value":"<code class=\"language-text\">npm install -D @andrew-codes/gatsby-plugin-elasticlunr-search</code>","position":{"start":{"line":9,"column":24,"offset":804},"end":{"line":9,"column":87,"offset":867}}},{"type":"text","value":". See the ","position":{"start":{"line":9,"column":87,"offset":867},"end":{"line":9,"column":97,"offset":877}}},{"type":"element","tagName":"a","properties":{"href":"https://github.com/andrew-codes/gatsby-plugin-elasticlunr-search-demo"},"children":[{"type":"text","value":"demo site repo","position":{"start":{"line":9,"column":98,"offset":878},"end":{"line":9,"column":112,"offset":892}}}],"position":{"start":{"line":9,"column":97,"offset":877},"end":{"line":9,"column":184,"offset":964}}},{"type":"text","value":" for more specific implementation details.","position":{"start":{"line":9,"column":184,"offset":964},"end":{"line":9,"column":226,"offset":1006}}}],"position":{"start":{"line":9,"column":1,"offset":781},"end":{"line":9,"column":226,"offset":1006}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Next, update your ","position":{"start":{"line":11,"column":1,"offset":1008},"end":{"line":11,"column":19,"offset":1026}}},{"type":"raw","value":"<code class=\"language-text\">gatsby-config.js</code>","position":{"start":{"line":11,"column":19,"offset":1026},"end":{"line":11,"column":37,"offset":1044}}},{"type":"text","value":" file to utilize the plugin.","position":{"start":{"line":11,"column":37,"offset":1044},"end":{"line":11,"column":65,"offset":1072}}}],"position":{"start":{"line":11,"column":1,"offset":1008},"end":{"line":11,"column":65,"offset":1072}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"setup-in-gatsby-config"},"children":[{"type":"element","tagName":"a","properties":{"href":"#setup-in-gatsby-config","aria-label":"setup in gatsby config permalink","class":"anchor"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Setup in ","position":{"start":{"line":13,"column":4,"offset":1077},"end":{"line":13,"column":13,"offset":1086}}},{"type":"raw","value":"<code class=\"language-text\">gatsby-config</code>","position":{"start":{"line":13,"column":13,"offset":1086},"end":{"line":13,"column":28,"offset":1101}}}],"position":{"start":{"line":13,"column":1,"offset":1074},"end":{"line":13,"column":28,"offset":1101}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    plugins<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">{</span>\n            resolve<span class=\"token punctuation\">:</span> <span class=\"token template-string\"><span class=\"token string\">`@andrew-codes/gatsby-plugin-elasticlunr-search`</span></span><span class=\"token punctuation\">,</span>\n            options<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token comment\">// Fields to index</span>\n                fields<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n                    <span class=\"token string\">'title'</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token string\">'keywords'</span><span class=\"token punctuation\">,</span>\n                <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                <span class=\"token comment\">// How to resolve each field's value for a supported node type</span>\n                resolvers<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token comment\">// For any node of type MarkdownRemark, list how to resolve the fields' values</span>\n                    MarkdownRemark<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                        title<span class=\"token punctuation\">:</span> node <span class=\"token operator\">=></span> node<span class=\"token punctuation\">.</span>frontmatter<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">,</span>\n                        keywords<span class=\"token punctuation\">:</span> node <span class=\"token operator\">=></span> node<span class=\"token punctuation\">.</span>frontmatter<span class=\"token punctuation\">.</span>keywords<span class=\"token punctuation\">,</span>\n                    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>","position":{"start":{"line":14,"column":1,"offset":1102},"end":{"line":37,"column":4,"offset":1853}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"consuming-in-your-site"},"children":[{"type":"element","tagName":"a","properties":{"href":"#consuming-in-your-site","aria-label":"consuming in your site permalink","class":"anchor"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Consuming in Your Site","position":{"start":{"line":39,"column":4,"offset":1858},"end":{"line":39,"column":26,"offset":1880}}}],"position":{"start":{"line":39,"column":1,"offset":1855},"end":{"line":39,"column":26,"offset":1880}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The serialized search index will be available via graphql. Once queried, a component can create a new elastic lunr index with the value retrieved from the graphql query. Search queries can be made against the hydrated search index. The results is an array of document IDs. The index can return the full document given a document ID","position":{"start":{"line":40,"column":1,"offset":1881},"end":{"line":40,"column":332,"offset":2212}}}],"position":{"start":{"line":40,"column":1,"offset":1881},"end":{"line":40,"column":332,"offset":2212}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>Component<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>Index<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'elasticlunr'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Graphql query used to retrieve the serialized search index.</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> query <span class=\"token operator\">=</span> graphql<span class=\"token template-string\"><span class=\"token string\">`query\nSearchIndexExampleQuery {\n    siteSearchIndex {\n      index\n    }\n}`</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Search component</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Search</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Component</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n            query<span class=\"token punctuation\">:</span> <span class=\"token template-string\"><span class=\"token string\">``</span></span><span class=\"token punctuation\">,</span>\n            results<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n            <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n                <span class=\"token operator\">&lt;</span>input type<span class=\"token operator\">=</span><span class=\"token string\">\"text\"</span> value<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>query<span class=\"token punctuation\">}</span> onChange<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>search<span class=\"token punctuation\">}</span><span class=\"token operator\">/</span><span class=\"token operator\">></span>\n                <span class=\"token operator\">&lt;</span>ul<span class=\"token operator\">></span>\n                    <span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>results<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>page <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n                        <span class=\"token operator\">&lt;</span>li<span class=\"token operator\">></span>\n                            <span class=\"token punctuation\">{</span>page<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">}</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>page<span class=\"token punctuation\">.</span>keywords<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token string\">`,`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n                        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>li<span class=\"token operator\">></span>\n                    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n                <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>ul<span class=\"token operator\">></span>\n            <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token function-variable function\">getOrCreateIndex</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>index\n        <span class=\"token operator\">?</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>index\n        <span class=\"token comment\">// Create an elastic lunr index and hydrate with graphql query results</span>\n        <span class=\"token punctuation\">:</span> Index<span class=\"token punctuation\">.</span><span class=\"token function\">load</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>siteSearchIndex<span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function-variable function\">search</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>evt<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">const</span> query <span class=\"token operator\">=</span> evt<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>index <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getOrCreateIndex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n            query<span class=\"token punctuation\">,</span>\n            <span class=\"token comment\">// Query the index with search string to get an [] of IDs</span>\n            results<span class=\"token punctuation\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">.</span><span class=\"token function\">search</span><span class=\"token punctuation\">(</span>query<span class=\"token punctuation\">)</span>\n                <span class=\"token comment\">// Map over each ID and return the full document</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n                ref<span class=\"token punctuation\">,</span>\n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">.</span>documentStore<span class=\"token punctuation\">.</span><span class=\"token function\">getDoc</span><span class=\"token punctuation\">(</span>ref<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":42,"column":1,"offset":2214},"end":{"line":98,"column":4,"offset":3762}}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":99,"column":1,"offset":3763}}}}