{"expireTime":9007200804686331000,"key":"transformer-remark-markdown-ast-892fe649f4f61069f2ab142163c15d00-gatsby-remark-graphvizgatsby-remark-code-titlesgatsby-remark-imagesgatsby-remark-responsive-iframegatsby-remark-autolink-headersgatsby-remark-prismjsgatsby-remark-copy-linked-filesgatsby-remark-smartypants-","val":{"type":"root","children":[{"type":"paragraph","children":[{"type":"text","value":"An important part of creating a very fast website is setting up proper HTTP caching. HTTP caching allows browsers to cache resources from a website so that when the user returns to a site, very few parts of the website have to be downloaded.","position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":242,"offset":242},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":242,"offset":242},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Different types of resources are cached differently. Let’s examine how the different types of files built to ","position":{"start":{"line":4,"column":1,"offset":244},"end":{"line":4,"column":110,"offset":353},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">public/</code>","position":{"start":{"line":4,"column":110,"offset":353},"end":{"line":4,"column":119,"offset":362},"indent":[]}},{"type":"text","value":" should be cached.","position":{"start":{"line":4,"column":119,"offset":362},"end":{"line":4,"column":137,"offset":380},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":244},"end":{"line":4,"column":137,"offset":380},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"link","url":"#html","title":null,"data":{"hProperties":{"aria-label":"html permalink","class":"anchor"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"HTML","position":{"start":{"line":6,"column":4,"offset":385},"end":{"line":6,"column":8,"offset":389},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":382},"end":{"line":6,"column":8,"offset":389},"indent":[]},"data":{"id":"html","htmlAttributes":{"id":"html"},"hProperties":{"id":"html"}}},{"type":"paragraph","children":[{"type":"text","value":"HTML files should never be cached. When you rebuild your Gatsby site, you often update the contents of HTML files. Because of this, browsers should be instructed to check on every request if they need to download a newer version of the HTML file.","position":{"start":{"line":8,"column":1,"offset":391},"end":{"line":8,"column":247,"offset":637},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":391},"end":{"line":8,"column":247,"offset":637},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":10,"column":1,"offset":639},"end":{"line":10,"column":5,"offset":643},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">cache-control</code>","position":{"start":{"line":10,"column":5,"offset":643},"end":{"line":10,"column":20,"offset":658},"indent":[]}},{"type":"text","value":" header should be ","position":{"start":{"line":10,"column":20,"offset":658},"end":{"line":10,"column":38,"offset":676},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">cache-control: public, max-age=0, must-revalidate</code>","position":{"start":{"line":10,"column":38,"offset":676},"end":{"line":10,"column":89,"offset":727},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":639},"end":{"line":10,"column":89,"offset":727},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"link","url":"#static-files","title":null,"data":{"hProperties":{"aria-label":"static files permalink","class":"anchor"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"Static files","position":{"start":{"line":12,"column":4,"offset":732},"end":{"line":12,"column":16,"offset":744},"indent":[]}}],"position":{"start":{"line":12,"column":1,"offset":729},"end":{"line":12,"column":16,"offset":744},"indent":[]},"data":{"id":"static-files","htmlAttributes":{"id":"static-files"},"hProperties":{"id":"static-files"}}},{"type":"paragraph","children":[{"type":"text","value":"All files in ","position":{"start":{"line":14,"column":1,"offset":746},"end":{"line":14,"column":14,"offset":759},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">public/static/</code>","position":{"start":{"line":14,"column":14,"offset":759},"end":{"line":14,"column":30,"offset":775},"indent":[]}},{"type":"text","value":" should be cached forever. For files in this directory, Gatsby creates paths that are directly tied to the content of the file. Meaning that if the file content changes, then the file path changes also. These paths look weird e.g. ","position":{"start":{"line":14,"column":30,"offset":775},"end":{"line":14,"column":261,"offset":1006},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">reactnext-gatsby-performance.001-a3e9d70183ff294e097c4319d0f8cff6-0b1ba.png</code>","position":{"start":{"line":14,"column":261,"offset":1006},"end":{"line":14,"column":338,"offset":1083},"indent":[]}},{"type":"text","value":" but since we know that we’ll always get the same file when we request that path, we can cache it forever.","position":{"start":{"line":14,"column":338,"offset":1083},"end":{"line":14,"column":444,"offset":1189},"indent":[]}}],"position":{"start":{"line":14,"column":1,"offset":746},"end":{"line":14,"column":444,"offset":1189},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":16,"column":1,"offset":1191},"end":{"line":16,"column":5,"offset":1195},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">cache-control</code>","position":{"start":{"line":16,"column":5,"offset":1195},"end":{"line":16,"column":20,"offset":1210},"indent":[]}},{"type":"text","value":" header should be ","position":{"start":{"line":16,"column":20,"offset":1210},"end":{"line":16,"column":38,"offset":1228},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">cache-control: public,max-age=31536000,immutable</code>","position":{"start":{"line":16,"column":38,"offset":1228},"end":{"line":16,"column":88,"offset":1278},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":1191},"end":{"line":16,"column":88,"offset":1278},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"link","url":"#javascript-and-css","title":null,"data":{"hProperties":{"aria-label":"javascript and css permalink","class":"anchor"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"JavaScript and CSS","position":{"start":{"line":18,"column":4,"offset":1283},"end":{"line":18,"column":22,"offset":1301},"indent":[]}}],"position":{"start":{"line":18,"column":1,"offset":1280},"end":{"line":18,"column":22,"offset":1301},"indent":[]},"data":{"id":"javascript-and-css","htmlAttributes":{"id":"javascript-and-css"},"hProperties":{"id":"javascript-and-css"}}},{"type":"paragraph","children":[{"type":"text","value":"JavaScript and CSS files ","position":{"start":{"line":20,"column":1,"offset":1303},"end":{"line":20,"column":26,"offset":1328},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"generated by webpack","position":{"start":{"line":20,"column":27,"offset":1329},"end":{"line":20,"column":47,"offset":1349},"indent":[]}}],"position":{"start":{"line":20,"column":26,"offset":1328},"end":{"line":20,"column":48,"offset":1350},"indent":[]}},{"type":"text","value":" should also be cached forever. Like static files, Gatsby creates JS & CSS file names (as a hash!) based on the file content. If the file content is changed, the file hash will change, therefore these files ","position":{"start":{"line":20,"column":48,"offset":1350},"end":{"line":20,"column":255,"offset":1557},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"generated by webpack","position":{"start":{"line":20,"column":256,"offset":1558},"end":{"line":20,"column":276,"offset":1578},"indent":[]}}],"position":{"start":{"line":20,"column":255,"offset":1557},"end":{"line":20,"column":277,"offset":1579},"indent":[]}},{"type":"text","value":" are safe to cache.","position":{"start":{"line":20,"column":277,"offset":1579},"end":{"line":20,"column":296,"offset":1598},"indent":[]}}],"position":{"start":{"line":20,"column":1,"offset":1303},"end":{"line":20,"column":296,"offset":1598},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":22,"column":1,"offset":1600},"end":{"line":22,"column":5,"offset":1604},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">cache-control</code>","position":{"start":{"line":22,"column":5,"offset":1604},"end":{"line":22,"column":20,"offset":1619},"indent":[]}},{"type":"text","value":" header should be ","position":{"start":{"line":22,"column":20,"offset":1619},"end":{"line":22,"column":38,"offset":1637},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">cache-control: public, max-age=31536000,immutable</code>","position":{"start":{"line":22,"column":38,"offset":1637},"end":{"line":22,"column":89,"offset":1688},"indent":[]}}],"position":{"start":{"line":22,"column":1,"offset":1600},"end":{"line":22,"column":89,"offset":1688},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The only exception to this is the file ","position":{"start":{"line":24,"column":1,"offset":1690},"end":{"line":24,"column":40,"offset":1729},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">/sw.js</code>","position":{"start":{"line":24,"column":40,"offset":1729},"end":{"line":24,"column":48,"offset":1737},"indent":[]}},{"type":"text","value":", which needs to be revalidated upon each load to check if a new version of the site is available. This file is generated by ","position":{"start":{"line":24,"column":48,"offset":1737},"end":{"line":24,"column":173,"offset":1862},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">gatsby-plugin-offline</code>","position":{"start":{"line":24,"column":173,"offset":1862},"end":{"line":24,"column":196,"offset":1885},"indent":[]}},{"type":"text","value":" and other service worker plugins, in order to serve content offline. Its ","position":{"start":{"line":24,"column":196,"offset":1885},"end":{"line":24,"column":270,"offset":1959},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">cache-control</code>","position":{"start":{"line":24,"column":270,"offset":1959},"end":{"line":24,"column":285,"offset":1974},"indent":[]}},{"type":"text","value":" header should be ","position":{"start":{"line":24,"column":285,"offset":1974},"end":{"line":24,"column":303,"offset":1992},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">cache-control: public, max-age=0, must-revalidate</code>","position":{"start":{"line":24,"column":303,"offset":1992},"end":{"line":24,"column":354,"offset":2043},"indent":[]}}],"position":{"start":{"line":24,"column":1,"offset":1690},"end":{"line":24,"column":354,"offset":2043},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"link","url":"#setting-up-caching-on-different-hosts","title":null,"data":{"hProperties":{"aria-label":"setting up caching on different hosts permalink","class":"anchor"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"Setting up caching on different hosts","position":{"start":{"line":26,"column":4,"offset":2048},"end":{"line":26,"column":41,"offset":2085},"indent":[]}}],"position":{"start":{"line":26,"column":1,"offset":2045},"end":{"line":26,"column":41,"offset":2085},"indent":[]},"data":{"id":"setting-up-caching-on-different-hosts","htmlAttributes":{"id":"setting-up-caching-on-different-hosts"},"hProperties":{"id":"setting-up-caching-on-different-hosts"}}},{"type":"paragraph","children":[{"type":"text","value":"How you setup your caching depends on how you host your site. We encourage people to create Gatsby plugins per host to automate the creation of caching headers.","position":{"start":{"line":28,"column":1,"offset":2087},"end":{"line":28,"column":161,"offset":2247},"indent":[]}}],"position":{"start":{"line":28,"column":1,"offset":2087},"end":{"line":28,"column":161,"offset":2247},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The following plugins have been created:","position":{"start":{"line":30,"column":1,"offset":2249},"end":{"line":30,"column":41,"offset":2289},"indent":[]}}],"position":{"start":{"line":30,"column":1,"offset":2249},"end":{"line":30,"column":41,"offset":2289},"indent":[]}},{"type":"list","ordered":false,"start":null,"loose":false,"children":[{"type":"listItem","loose":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"/packages/gatsby-plugin-netlify/","children":[{"type":"text","value":"gatsby-plugin-netlify","position":{"start":{"line":32,"column":4,"offset":2294},"end":{"line":32,"column":25,"offset":2315},"indent":[]}}],"position":{"start":{"line":32,"column":3,"offset":2293},"end":{"line":32,"column":60,"offset":2350},"indent":[]}}],"position":{"start":{"line":32,"column":3,"offset":2293},"end":{"line":32,"column":60,"offset":2350},"indent":[]}}],"position":{"start":{"line":32,"column":1,"offset":2291},"end":{"line":32,"column":60,"offset":2350},"indent":[]}},{"type":"listItem","loose":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"https://github.com/jariz/gatsby-plugin-s3","children":[{"type":"text","value":"gatsby-plugin-s3","position":{"start":{"line":33,"column":4,"offset":2354},"end":{"line":33,"column":20,"offset":2370},"indent":[]}}],"position":{"start":{"line":33,"column":3,"offset":2353},"end":{"line":33,"column":64,"offset":2414},"indent":[]}}],"position":{"start":{"line":33,"column":3,"offset":2353},"end":{"line":33,"column":64,"offset":2414},"indent":[]}}],"position":{"start":{"line":33,"column":1,"offset":2351},"end":{"line":33,"column":64,"offset":2414},"indent":[]}}],"position":{"start":{"line":32,"column":1,"offset":2291},"end":{"line":33,"column":64,"offset":2414},"indent":[1]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":34,"column":1,"offset":2415}}}}