{"expireTime":9007200804686348000,"key":"transformer-remark-markdown-html-c795dc9b4ef4685f3ab5e691d6b021ab-gatsby-remark-graphvizgatsby-remark-code-titlesgatsby-remark-imagesgatsby-remark-responsive-iframegatsby-remark-autolink-headersgatsby-remark-prismjsgatsby-remark-copy-linked-filesgatsby-remark-smartypants-","val":"<p>Knowing your components look as intended in every permutation is not only a great way to test them visually, but also provides “living documentation” for them. This makes it easier for teams to:</p>\n<ol>\n<li>know what components are available to them in a given project and</li>\n<li>what props those components accept and what all of the states of that component are.</li>\n</ol>\n<p>As your project grows over time having this information available will be invaluable. This is the function of the <a href=\"https://storybook.js.org/\">Storybook</a> library. Storybook is a UI development environment for your UI components. With it, you can visualize different states of your UI components and develop them interactively.</p>\n<h2 id=\"setting-up-your-environment\"><a href=\"#setting-up-your-environment\" aria-label=\"setting up your environment permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Setting up your environment</h2>\n<p>To set up Storybook you need to install dependencies and do some custom configuration. First, install the Storybook CLI.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> -g @storybook/cli</code></pre></div>\n<p>Once the CLI is installed, the next step is to run the <code class=\"language-text\">sb init</code> command that is now available from the root directory of your Gatsby project.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">cd</span> my-awesome-gatsby-project\nsb init</code></pre></div>\n<blockquote>\n<p>Note that if you’re running a recent version of <code class=\"language-text\">npm</code> (5.2.0+) you can run the following single command instead: <code class=\"language-text\">npx -p @storybook/cli sb init</code>, which is the recommended method by Storybook. This doesn’t install the CLI on your machine, thereby ensuring you’re always running the latest version of the CLI.</p>\n</blockquote>\n<p>The <code class=\"language-text\">sb init</code> command bootstraps the basic config necessary to run Storybook for a React project. However, since this is for a Gatsby project, you need to update the default Storybook configuration a bit so you don’t get errors when trying to use Gatsby specific components inside of the stories.</p>\n<p>To update your Storybook config open <code class=\"language-text\">.storybook/config.js</code> and modify the content as follows:</p>\n<div class=\"gatsby-code-title\">.storybook/config.js</div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> configure <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@storybook/react\"</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> action <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@storybook/addon-actions\"</span>\n\n<span class=\"token comment\">// automatically import all files ending in *.stories.js</span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">const</span> req <span class=\"token operator\">=</span> require<span class=\"token punctuation\">.</span><span class=\"token function\">context</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"../src\"</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> <span class=\"token regex\">/.stories.js$/</span><span class=\"token punctuation\">)</span></span><span class=\"token keyword\">function</span> <span class=\"token function\">loadStories</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  req<span class=\"token punctuation\">.</span><span class=\"token function\">keys</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span>filename <span class=\"token operator\">=></span> <span class=\"token function\">req</span><span class=\"token punctuation\">(</span>filename<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"gatsby-highlight-code-line\"><span class=\"token comment\">// Gatsby's Link overrides:</span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token comment\">// Gatsby defines a global called ___loader to prevent its method calls from creating console errors you override it here</span></span><span class=\"gatsby-highlight-code-line\">global<span class=\"token punctuation\">.</span>___loader <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">  enqueue<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">  hovering<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token punctuation\">}</span></span><span class=\"gatsby-highlight-code-line\"></span><span class=\"gatsby-highlight-code-line\"><span class=\"token comment\">// Gatsby internal mocking to prevent unnecessary errors in storybook testing environment</span></span><span class=\"gatsby-highlight-code-line\">global<span class=\"token punctuation\">.</span>__PATH_PREFIX__ <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span></span><span class=\"gatsby-highlight-code-line\"></span><span class=\"gatsby-highlight-code-line\"><span class=\"token comment\">// This is to utilized to override the window.___navigate method Gatsby defines and uses to report what path a Link would be taking us to if it wasn't inside a storybook</span></span><span class=\"gatsby-highlight-code-line\">window<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">___navigate</span> <span class=\"token operator\">=</span> pathname <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">action</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"NavigateTo:\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>pathname<span class=\"token punctuation\">)</span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token punctuation\">}</span></span><span class=\"gatsby-highlight-code-line\"></span><span class=\"gatsby-highlight-code-line\"><span class=\"token function\">configure</span><span class=\"token punctuation\">(</span>loadStories<span class=\"token punctuation\">,</span> module<span class=\"token punctuation\">)</span></span></code></pre></div>\n<blockquote>\n<p>You can remove the <code class=\"language-text\">stories</code> folder from the root of your project, or move it inside your <code class=\"language-text\">src</code> folder</p>\n</blockquote>\n<p>Next make some adjustments to Storybook’s default <code class=\"language-text\">webpack</code> configuration so you can transpile Gatsby source files, and to ensure you have the necessary <code class=\"language-text\">babel</code> plugins to transpile Gatsby components.</p>\n<p>Create a new file called <code class=\"language-text\">webpack.config.js</code> in the <code class=\"language-text\">.storybook</code> folder created by the Storybook CLI. Then place the following in that file.</p>\n<div class=\"gatsby-code-title\">.storybook/webpack.config.js</div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">module<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">exports</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>baseConfig<span class=\"token punctuation\">,</span> env<span class=\"token punctuation\">,</span> defaultConfig<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Transpile Gatsby module because Gatsby includes un-transpiled ES6 code.</span>\n  defaultConfig<span class=\"token punctuation\">.</span>module<span class=\"token punctuation\">.</span>rules<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>exclude <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token regex\">/node_modules\\/(?!(gatsby)\\/)/</span><span class=\"token punctuation\">]</span>\n\n  <span class=\"token comment\">// use installed babel-loader which is v8.0-beta (which is meant to work with @babel/core@7)</span>\n  defaultConfig<span class=\"token punctuation\">.</span>module<span class=\"token punctuation\">.</span>rules<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>use<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>loader <span class=\"token operator\">=</span> require<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"babel-loader\"</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token comment\">// use @babel/preset-react for JSX and env (instead of staged presets)</span>\n  defaultConfig<span class=\"token punctuation\">.</span>module<span class=\"token punctuation\">.</span>rules<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>use<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>options<span class=\"token punctuation\">.</span>presets <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    require<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"@babel/preset-react\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    require<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"@babel/preset-env\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span>\n\n  <span class=\"token comment\">// use @babel/plugin-proposal-class-properties for class arrow functions</span>\n  defaultConfig<span class=\"token punctuation\">.</span>module<span class=\"token punctuation\">.</span>rules<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>use<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>options<span class=\"token punctuation\">.</span>plugins <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    require<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"@babel/plugin-proposal-class-properties\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span>\n\n  <span class=\"token comment\">// Prefer Gatsby ES6 entrypoint (module) over commonjs (main) entrypoint</span>\n  defaultConfig<span class=\"token punctuation\">.</span>resolve<span class=\"token punctuation\">.</span>mainFields <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"browser\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"module\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"main\"</span><span class=\"token punctuation\">]</span>\n\n  <span class=\"token keyword\">return</span> defaultConfig\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Once you have this configured you should run Storybook to ensure it can start up properly and you can see the default stories installed by the CLI. To run storybook:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">npm</span> run storybook</code></pre></div>\n<p>Storybook CLI adds this command to your <code class=\"language-text\">package.json</code> for you so you shouldn’t have to anything other than run the command. If Storybook builds successfully you should be able to navigate to <code class=\"language-text\">http://localhost:6006</code> and see the default stories supplied by the Storybook CLI.</p>\n<h2 id=\"writing-stories\"><a href=\"#writing-stories\" aria-label=\"writing stories permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Writing stories</h2>\n<p>A full guide to writing stories is beyond the scope of this guide, but we’ll take a look at creating a story.</p>\n<p>First, create the story file. Storybook looks for all files with a <code class=\"language-text\">.stories.js</code> extension and loads them into Storybook for you. Generally you will want your stories near where the component is defined, however since this is Gatsby, if you want stories for your pages, you will have to create those files outside of the <code class=\"language-text\">pages</code> directory.</p>\n<blockquote>\n<p>A good solution is to create a <code class=\"language-text\">__stories__</code> directory next to your <code class=\"language-text\">pages</code> directory and put any page stories in there.</p>\n</blockquote>\n<div class=\"gatsby-code-title\">src/components/example.stories.js</div>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> storiesOf <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@storybook/react\"</span>\n\n<span class=\"token function\">storiesOf</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token string\">`Dashboard/Header`</span></span><span class=\"token punctuation\">,</span> module<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token string\">`default`</span></span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> padding<span class=\"token punctuation\">:</span> <span class=\"token template-string\"><span class=\"token string\">`16px`</span></span><span class=\"token punctuation\">,</span> backgroundColor<span class=\"token punctuation\">:</span> <span class=\"token template-string\"><span class=\"token string\">`#eeeeee`</span></span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span> <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> color<span class=\"token punctuation\">:</span> <span class=\"token string\">\"rebeccapurple\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Hello from Storybook and Gatsby!</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>This is a very simple story without much going on, but honestly, nothing else really changes as related to Gatsby. If you want to learn more about how Storybook works and what you can do with it, check out some of the resources listed below.</p>\n<h2 id=\"other-resources\"><a href=\"#other-resources\" aria-label=\"other resources permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Other resources</h2>\n<ul>\n<li>For more information on Storybook, visit\n<a href=\"https://storybook.js.org/\">the Storybook site</a>.</li>\n<li>Get started with a <a href=\"https://github.com/Mathspy/gatsby-storybook-jest-starter\">Jest and Storybook starter</a></li>\n</ul>"}