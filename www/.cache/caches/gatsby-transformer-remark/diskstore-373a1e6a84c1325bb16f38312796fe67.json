{"expireTime":9007200804686334000,"key":"transformer-remark-markdown-html-c73dce768476a9f34694389a9ae10b89-gatsby-remark-graphvizgatsby-remark-code-titlesgatsby-remark-imagesgatsby-remark-responsive-iframegatsby-remark-autolink-headersgatsby-remark-prismjsgatsby-remark-copy-linked-filesgatsby-remark-smartypants-","val":"<p>There are two types of plugins that work within Gatsby’s data system, “source”\nand “transformer” plugins.</p>\n<ul>\n<li><strong>Source</strong> plugins “source” data from remote or local locations into what\nGatsby calls <a href=\"/docs/node-interface/\">nodes</a>.</li>\n<li><strong>Transformer</strong> plugins “transform” data provided by source plugins into new\nnodes and/or node fields.</li>\n</ul>\n<p>The purpose of this doc is to:</p>\n<ol>\n<li>Define what a Gatsby transformer plugin is, and</li>\n<li>Walk through a simplified reimplementation of an existing plugin, to demonstrate how to create a transformer plugin.</li>\n</ol>\n<h2 id=\"what-do-transformer-plugins-do\"><a href=\"#what-do-transformer-plugins-do\" aria-label=\"what do transformer plugins do permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>What do transformer plugins do?</h2>\n<p>Transformer plugins “transform” data of one type into another type. You’ll often use both source plugins and transformer plugins in your Gatsby sites.</p>\n<p>This loose coupling between the data source and transformer plugins allow Gatsby developers to quickly assemble complex data transformation pipelines with little work.</p>\n<h2 id=\"how-do-you-create-a-transformer-plugin\"><a href=\"#how-do-you-create-a-transformer-plugin\" aria-label=\"how do you create a transformer plugin permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>How do you create a transformer plugin?</h2>\n<p>Just like a source plugin, a transformer plugin is a normal NPM package. It has a <code class=\"language-text\">package.json</code> file with optional dependencies as well as a <code class=\"language-text\">gatsby-node.js</code> file where you implement Gatsby’s Node.js APIs.</p>\n<p><code class=\"language-text\">gatsby-transformer-yaml</code> is transformer plugin that looks for new nodes with a media type of text/yaml (e.g. a .yaml file) and creates new YAML child node(s) by parsing the YAML source into JavaScript objects.</p>\n<p>As an example, let’s partially rebuild a simplified <code class=\"language-text\">gatsby-transformer-yaml</code> directly in an example site. Let’s say we have a default gatsby starter site which includes a YAML file:</p>\n<div class=\"gatsby-code-title\">src/data/example.yml</div>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Jane Doe\n  <span class=\"token key atrule\">bio</span><span class=\"token punctuation\">:</span> Developer based in Somewhere<span class=\"token punctuation\">,</span> USA\n<span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> John Smith\n  <span class=\"token key atrule\">bio</span><span class=\"token punctuation\">:</span> Developer based in Maintown<span class=\"token punctuation\">,</span> USA</code></pre></div>\n<h3 id=\"make-sure-the-data-is-sourced\"><a href=\"#make-sure-the-data-is-sourced\" aria-label=\"make sure the data is sourced permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Make sure the data is sourced</h3>\n<p>First, in <code class=\"language-text\">gatsby-config.js</code>, use the <code class=\"language-text\">gatsby-source-filesystem</code> plugin to create File nodes.</p>\n<div class=\"gatsby-code-title\">gatsby-config.js</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  plugins<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      resolve<span class=\"token punctuation\">:</span> <span class=\"token template-string\"><span class=\"token string\">`gatsby-source-filesystem`</span></span><span class=\"token punctuation\">,</span>\n      options<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        path<span class=\"token punctuation\">:</span> <span class=\"token template-string\"><span class=\"token string\">`./src/data/`</span></span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>These are exposed in your graphql schema which you can query:</p>\n<div class=\"gatsby-highlight\" data-language=\"graphql\"><pre class=\"language-graphql\"><code class=\"language-graphql\"><span class=\"token keyword\">query</span> <span class=\"token punctuation\">{</span>\n  allFile <span class=\"token punctuation\">{</span>\n    edges <span class=\"token punctuation\">{</span>\n      node <span class=\"token punctuation\">{</span>\n        internal <span class=\"token punctuation\">{</span>\n          type\n          mediaType\n          description\n          owner\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Now you have a <code class=\"language-text\">File</code> node to work with:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"data\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"allFile\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"edges\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">{</span>\n          <span class=\"token property\">\"node\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token property\">\"internal\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n              <span class=\"token property\">\"contentDigest\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"c1644b03f380bc5508456ce91faf0c08\"</span><span class=\"token punctuation\">,</span>\n              <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"File\"</span><span class=\"token punctuation\">,</span>\n              <span class=\"token property\">\"mediaType\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"text/yaml\"</span><span class=\"token punctuation\">,</span>\n              <span class=\"token property\">\"description\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"File \\\"src/data/example.yml\\\"\"</span><span class=\"token punctuation\">,</span>\n              <span class=\"token property\">\"owner\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"gatsby-source-filesystem\"</span>\n            <span class=\"token punctuation\">}</span>\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"transform-nodes-of-type-textyaml\"><a href=\"#transform-nodes-of-type-textyaml\" aria-label=\"transform nodes of type textyaml permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Transform nodes of type <code class=\"language-text\">text/yaml</code></h3>\n<p>Now, transform the newly created <code class=\"language-text\">File</code> nodes by hooking into the <code class=\"language-text\">onCreateNode</code> API in <code class=\"language-text\">gatsby-node.js</code>.</p>\n<p>If you’re following along in an example project, install the following packages:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> --save js-yaml lodash</code></pre></div>\n<p>Now, in <code class=\"language-text\">gatsby-node.js</code>:</p>\n<div class=\"gatsby-code-title\">gatsby-node.js</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> jsYaml <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token string\">`js-yaml`</span></span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">onCreateNode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> node<span class=\"token punctuation\">,</span> loadNodeContent <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// only log for nodes of mediaType `text/yaml`</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">.</span>internal<span class=\"token punctuation\">.</span>mediaType <span class=\"token operator\">!==</span> <span class=\"token template-string\"><span class=\"token string\">`text/yaml`</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">const</span> fileContent <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">loadNodeContent</span><span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> parsedContent <span class=\"token operator\">=</span> jsYaml<span class=\"token punctuation\">.</span><span class=\"token function\">load</span><span class=\"token punctuation\">(</span>content<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\nexports<span class=\"token punctuation\">.</span>onCreateNode <span class=\"token operator\">=</span> onCreateNode</code></pre></div>\n<p>File content:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">- id: Jane Doe\n  bio: Developer based in Somewhere, USA\n- id: John Smith\n  bio: Developer based in Maintown, USA</code></pre></div>\n<p>Parsed YAML content:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token punctuation\">;</span><span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span>\n    id<span class=\"token punctuation\">:</span> <span class=\"token string\">\"Jane Doe\"</span><span class=\"token punctuation\">,</span>\n    bio<span class=\"token punctuation\">:</span> <span class=\"token string\">\"Developer based in Somewhere, USA\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span>\n    id<span class=\"token punctuation\">:</span> <span class=\"token string\">\"John Smith\"</span><span class=\"token punctuation\">,</span>\n    bio<span class=\"token punctuation\">:</span> <span class=\"token string\">\"Developer based in Maintown, USA\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span></code></pre></div>\n<p>Now we’ll write a helper function to transform the parsed YAML content into new Gatsby nodes:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">transformObject</span><span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">,</span> id<span class=\"token punctuation\">,</span> type<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> yamlNode <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token operator\">...</span>obj<span class=\"token punctuation\">,</span>\n    id<span class=\"token punctuation\">,</span>\n    children<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    parent<span class=\"token punctuation\">:</span> node<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span>\n    internal<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n      contentDigest<span class=\"token punctuation\">:</span> <span class=\"token function\">createContentDigest</span><span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      type<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">createNode</span><span class=\"token punctuation\">(</span>yamlNode<span class=\"token punctuation\">)</span>\n  <span class=\"token function\">createParentChildLink</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> parent<span class=\"token punctuation\">:</span> node<span class=\"token punctuation\">,</span> child<span class=\"token punctuation\">:</span> yamlNode <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Above, we create a <code class=\"language-text\">yamlNode</code> object with the shape expected by the <a href=\"/docs/actions/#createNode\"><code class=\"language-text\">createNode</code> action</a>.</p>\n<p>We then create a link between the parent node (file) and the child node (yaml content).</p>\n<p>In our updated <code class=\"language-text\">gatsby-node.js</code>, we’ll then iterate through the parsed YAML content, using the helper function to transform each into a new node:</p>\n<div class=\"gatsby-code-title\">gatsby-node.js</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> jsYaml <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token string\">`js-yaml`</span></span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> _ <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token string\">`lodash`</span></span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">onCreateNode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  node<span class=\"token punctuation\">,</span>\n<span class=\"gatsby-highlight-code-line\">  actions<span class=\"token punctuation\">,</span></span>  loadNodeContent<span class=\"token punctuation\">,</span>\n<span class=\"gatsby-highlight-code-line\">  createNodeId<span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">  createContentDigest<span class=\"token punctuation\">,</span></span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">function</span> <span class=\"token function\">transformObject</span><span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">,</span> id<span class=\"token punctuation\">,</span> type<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">const</span> yamlNode <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token operator\">...</span>obj<span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">      id<span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">      children<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">      parent<span class=\"token punctuation\">:</span> node<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">      internal<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">        contentDigest<span class=\"token punctuation\">:</span> <span class=\"token function\">createContentDigest</span><span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">        type<span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span></span><span class=\"gatsby-highlight-code-line\"></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token function\">createNode</span><span class=\"token punctuation\">(</span>yamlNode<span class=\"token punctuation\">)</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token function\">createParentChildLink</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> parent<span class=\"token punctuation\">:</span> node<span class=\"token punctuation\">,</span> child<span class=\"token punctuation\">:</span> yamlNode <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span></span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> createNode<span class=\"token punctuation\">,</span> createParentChildLink <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> actions\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">.</span>internal<span class=\"token punctuation\">.</span>mediaType <span class=\"token operator\">!==</span> <span class=\"token template-string\"><span class=\"token string\">`text/yaml`</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">const</span> content <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">loadNodeContent</span><span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> parsedContent <span class=\"token operator\">=</span> jsYaml<span class=\"token punctuation\">.</span><span class=\"token function\">load</span><span class=\"token punctuation\">(</span>content<span class=\"token punctuation\">)</span>\n\n<span class=\"gatsby-highlight-code-line\">  parsedContent<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token function\">transformObject</span><span class=\"token punctuation\">(</span></span><span class=\"gatsby-highlight-code-line\">      obj<span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">      obj<span class=\"token punctuation\">.</span>id <span class=\"token operator\">?</span> obj<span class=\"token punctuation\">.</span>id <span class=\"token punctuation\">:</span> <span class=\"token function\">createNodeId</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>node<span class=\"token punctuation\">.</span>id<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> [</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>i<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">] >>> YAML`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">      _<span class=\"token punctuation\">.</span><span class=\"token function\">upperFirst</span><span class=\"token punctuation\">(</span>_<span class=\"token punctuation\">.</span><span class=\"token function\">camelCase</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>node<span class=\"token punctuation\">.</span>name<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> Yaml`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">)</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">}</span>\n\nexports<span class=\"token punctuation\">.</span>onCreateNode <span class=\"token operator\">=</span> onCreateNode</code></pre></div>\n<p>Now we can query for our new nodes containing our transformed YAML data:</p>\n<div class=\"gatsby-highlight\" data-language=\"graphql\"><pre class=\"language-graphql\"><code class=\"language-graphql\"><span class=\"token keyword\">query</span> <span class=\"token punctuation\">{</span>\n  allExampleYaml <span class=\"token punctuation\">{</span>\n    edges <span class=\"token punctuation\">{</span>\n      node <span class=\"token punctuation\">{</span>\n        id\n        name\n        bio\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"data\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"allExampleYaml\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"edges\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">{</span>\n          <span class=\"token property\">\"node\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"3baa5e64-ac2a-5234-ba35-7af86746713f\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Jane Doe\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token property\">\"bio\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Developer based in Somewhere, USA\"</span>\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">{</span>\n          <span class=\"token property\">\"node\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"2c733815-c342-5d85-aa3f-6795d0f25909\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"John Smith\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token property\">\"bio\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Developer based in Maintown, USA\"</span>\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Check out the <a href=\"https://github.com/gatsbyjs/gatsby/blob/master/packages/gatsby-transformer-yaml/src/gatsby-node.js\">full source code</a> of <code class=\"language-text\">gatsby-transformer-yaml</code>.</p>\n<h2 id=\"using-the-cache\"><a href=\"#using-the-cache\" aria-label=\"using the cache permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Using the cache</h2>\n<p>Sometimes transforming properties costs time and resources. In order to avoid recreating these properties at each run, you can profit from the global cache mechanism Gatsby provides.</p>\n<p>Cache keys should at least contain the contentDigest of the concerned. For example, the <code class=\"language-text\">gatsby-transformer-remark</code> uses the following cache key for the html node:</p>\n<div class=\"gatsby-code-title\">extend-node-type.js</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">htmlCacheKey</span> <span class=\"token operator\">=</span> node <span class=\"token operator\">=></span>\n  <span class=\"token template-string\"><span class=\"token string\">`transformer-remark-markdown-html-</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>\n    node<span class=\"token punctuation\">.</span>internal<span class=\"token punctuation\">.</span>contentDigest\n  <span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">-</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>pluginsCacheStr<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">-</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>pathPrefixCacheStr<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">`</span></span></code></pre></div>\n<p>Accessing and setting content in the cache is as simple as:</p>\n<div class=\"gatsby-code-title\">extend-node-type.js</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> cachedHTML <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> cache<span class=\"token punctuation\">.</span><span class=\"token keyword\">get</span><span class=\"token punctuation\">(</span><span class=\"token function\">htmlCacheKey</span><span class=\"token punctuation\">(</span>markdownNode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\ncache<span class=\"token punctuation\">.</span><span class=\"token keyword\">set</span><span class=\"token punctuation\">(</span><span class=\"token function\">htmlCacheKey</span><span class=\"token punctuation\">(</span>markdownNode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> html<span class=\"token punctuation\">)</span></code></pre></div>"}