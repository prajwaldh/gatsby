{"expireTime":9007200804686339000,"key":"transformer-remark-markdown-ast-0e0778aa2267c0c03bda8baf5d14689b-gatsby-remark-graphvizgatsby-remark-code-titlesgatsby-remark-imagesgatsby-remark-responsive-iframegatsby-remark-autolink-headersgatsby-remark-prismjsgatsby-remark-copy-linked-filesgatsby-remark-smartypants-","val":{"type":"root","children":[{"type":"paragraph","children":[{"type":"text","value":"For most sites, plugins take up the majority of the build time. So what’s really happening when APIs are called?","position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":113,"offset":113},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":113,"offset":113},"indent":[]}},{"type":"paragraph","children":[{"type":"emphasis","children":[{"type":"text","value":"Note: this section only explains how ","position":{"start":{"line":4,"column":2,"offset":116},"end":{"line":4,"column":39,"offset":153},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">gatsby-node</code>","position":{"start":{"line":4,"column":39,"offset":153},"end":{"line":4,"column":52,"offset":166},"indent":[]}},{"type":"text","value":" plugins are run. Not browser or ssr plugins","position":{"start":{"line":4,"column":52,"offset":166},"end":{"line":4,"column":96,"offset":210},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":115},"end":{"line":4,"column":97,"offset":211},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":115},"end":{"line":4,"column":97,"offset":211},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"link","url":"#early-in-the-build","title":null,"data":{"hProperties":{"aria-label":"early in the build permalink","class":"anchor"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"Early in the build","position":{"start":{"line":6,"column":4,"offset":216},"end":{"line":6,"column":22,"offset":234},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":213},"end":{"line":6,"column":22,"offset":234},"indent":[]},"data":{"id":"early-in-the-build","htmlAttributes":{"id":"early-in-the-build"},"hProperties":{"id":"early-in-the-build"}}},{"type":"paragraph","children":[{"type":"text","value":"Early in the bootstrap phase, we ","position":{"start":{"line":8,"column":1,"offset":236},"end":{"line":8,"column":34,"offset":269},"indent":[]}},{"type":"link","title":null,"url":"https://github.com/gatsbyjs/gatsby/blob/8029c6647ab38792bb0a7c135ab4b98ae70a2627/packages/gatsby/src/bootstrap/load-plugins/index.js#L40","children":[{"type":"text","value":"load all the configured plugins","position":{"start":{"line":8,"column":35,"offset":270},"end":{"line":8,"column":66,"offset":301},"indent":[]}}],"position":{"start":{"line":8,"column":34,"offset":269},"end":{"line":8,"column":205,"offset":440},"indent":[]}},{"type":"text","value":" (and internal plugins) for the site. These are saved into redux under the ","position":{"start":{"line":8,"column":205,"offset":440},"end":{"line":8,"column":280,"offset":515},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">flattenedPlugins</code>","position":{"start":{"line":8,"column":280,"offset":515},"end":{"line":8,"column":298,"offset":533},"indent":[]}},{"type":"text","value":" namespace. Each plugin in redux contains the following fields:","position":{"start":{"line":8,"column":298,"offset":533},"end":{"line":8,"column":361,"offset":596},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":236},"end":{"line":8,"column":361,"offset":596},"indent":[]}},{"type":"list","ordered":false,"start":null,"loose":false,"children":[{"type":"listItem","loose":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"resolve","position":{"start":{"line":10,"column":5,"offset":602},"end":{"line":10,"column":12,"offset":609},"indent":[]}}],"position":{"start":{"line":10,"column":3,"offset":600},"end":{"line":10,"column":14,"offset":611},"indent":[]}},{"type":"text","value":": absolute path to the plugin’s directory","position":{"start":{"line":10,"column":14,"offset":611},"end":{"line":10,"column":55,"offset":652},"indent":[]}}],"position":{"start":{"line":10,"column":3,"offset":600},"end":{"line":10,"column":55,"offset":652},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":598},"end":{"line":10,"column":55,"offset":652},"indent":[]}},{"type":"listItem","loose":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"id","position":{"start":{"line":11,"column":5,"offset":657},"end":{"line":11,"column":7,"offset":659},"indent":[]}}],"position":{"start":{"line":11,"column":3,"offset":655},"end":{"line":11,"column":9,"offset":661},"indent":[]}},{"type":"text","value":": String concatenation of ‘Plugin ’ and the name of the plugin. E.g ","position":{"start":{"line":11,"column":9,"offset":661},"end":{"line":11,"column":77,"offset":729},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">Plugin query-runner</code>","position":{"start":{"line":11,"column":77,"offset":729},"end":{"line":11,"column":98,"offset":750},"indent":[]}}],"position":{"start":{"line":11,"column":3,"offset":655},"end":{"line":11,"column":98,"offset":750},"indent":[]}}],"position":{"start":{"line":11,"column":1,"offset":653},"end":{"line":11,"column":98,"offset":750},"indent":[]}},{"type":"listItem","loose":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"name","position":{"start":{"line":12,"column":5,"offset":755},"end":{"line":12,"column":9,"offset":759},"indent":[]}}],"position":{"start":{"line":12,"column":3,"offset":753},"end":{"line":12,"column":11,"offset":761},"indent":[]}},{"type":"text","value":": The name of the plugin. E.g ","position":{"start":{"line":12,"column":11,"offset":761},"end":{"line":12,"column":41,"offset":791},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">query-runner</code>","position":{"start":{"line":12,"column":41,"offset":791},"end":{"line":12,"column":55,"offset":805},"indent":[]}}],"position":{"start":{"line":12,"column":3,"offset":753},"end":{"line":12,"column":55,"offset":805},"indent":[]}}],"position":{"start":{"line":12,"column":1,"offset":751},"end":{"line":12,"column":55,"offset":805},"indent":[]}},{"type":"listItem","loose":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"version","position":{"start":{"line":13,"column":5,"offset":810},"end":{"line":13,"column":12,"offset":817},"indent":[]}}],"position":{"start":{"line":13,"column":3,"offset":808},"end":{"line":13,"column":14,"offset":819},"indent":[]}},{"type":"text","value":": The version as per the package.json. Or if it is a site plugin, one is generated from the file’s hash","position":{"start":{"line":13,"column":14,"offset":819},"end":{"line":13,"column":117,"offset":922},"indent":[]}}],"position":{"start":{"line":13,"column":3,"offset":808},"end":{"line":13,"column":117,"offset":922},"indent":[]}}],"position":{"start":{"line":13,"column":1,"offset":806},"end":{"line":13,"column":117,"offset":922},"indent":[]}},{"type":"listItem","loose":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"pluginOptions","position":{"start":{"line":14,"column":5,"offset":927},"end":{"line":14,"column":18,"offset":940},"indent":[]}}],"position":{"start":{"line":14,"column":3,"offset":925},"end":{"line":14,"column":20,"offset":942},"indent":[]}},{"type":"text","value":": Plugin options as specified in ","position":{"start":{"line":14,"column":20,"offset":942},"end":{"line":14,"column":53,"offset":975},"indent":[]}},{"type":"link","title":null,"url":"/docs/gatsby-config/","children":[{"type":"text","value":"gatsby-config.js","position":{"start":{"line":14,"column":54,"offset":976},"end":{"line":14,"column":70,"offset":992},"indent":[]}}],"position":{"start":{"line":14,"column":53,"offset":975},"end":{"line":14,"column":93,"offset":1015},"indent":[]}}],"position":{"start":{"line":14,"column":3,"offset":925},"end":{"line":14,"column":93,"offset":1015},"indent":[]}}],"position":{"start":{"line":14,"column":1,"offset":923},"end":{"line":14,"column":93,"offset":1015},"indent":[]}},{"type":"listItem","loose":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"nodeAPIs","position":{"start":{"line":15,"column":5,"offset":1020},"end":{"line":15,"column":13,"offset":1028},"indent":[]}}],"position":{"start":{"line":15,"column":3,"offset":1018},"end":{"line":15,"column":15,"offset":1030},"indent":[]}},{"type":"text","value":": A list of node APIs that this plugin implements. E.g ","position":{"start":{"line":15,"column":15,"offset":1030},"end":{"line":15,"column":70,"offset":1085},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">[ &#39;sourceNodes&#39;, ...]</code>","position":{"start":{"line":15,"column":70,"offset":1085},"end":{"line":15,"column":93,"offset":1108},"indent":[]}}],"position":{"start":{"line":15,"column":3,"offset":1018},"end":{"line":15,"column":93,"offset":1108},"indent":[]}}],"position":{"start":{"line":15,"column":1,"offset":1016},"end":{"line":15,"column":93,"offset":1108},"indent":[]}},{"type":"listItem","loose":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"browserAPIs","position":{"start":{"line":16,"column":5,"offset":1113},"end":{"line":16,"column":16,"offset":1124},"indent":[]}}],"position":{"start":{"line":16,"column":3,"offset":1111},"end":{"line":16,"column":18,"offset":1126},"indent":[]}},{"type":"text","value":": List of browser APIs that this plugin implements","position":{"start":{"line":16,"column":18,"offset":1126},"end":{"line":16,"column":68,"offset":1176},"indent":[]}}],"position":{"start":{"line":16,"column":3,"offset":1111},"end":{"line":16,"column":68,"offset":1176},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":1109},"end":{"line":16,"column":68,"offset":1176},"indent":[]}},{"type":"listItem","loose":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"ssrAPIs","position":{"start":{"line":17,"column":5,"offset":1181},"end":{"line":17,"column":12,"offset":1188},"indent":[]}}],"position":{"start":{"line":17,"column":3,"offset":1179},"end":{"line":17,"column":14,"offset":1190},"indent":[]}},{"type":"text","value":": List of SSR APIs that this plugin implements","position":{"start":{"line":17,"column":14,"offset":1190},"end":{"line":17,"column":60,"offset":1236},"indent":[]}}],"position":{"start":{"line":17,"column":3,"offset":1179},"end":{"line":17,"column":60,"offset":1236},"indent":[]}}],"position":{"start":{"line":17,"column":1,"offset":1177},"end":{"line":17,"column":60,"offset":1236},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":598},"end":{"line":17,"column":60,"offset":1236},"indent":[1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"In addition, we also create a lookup from api to the plugins that implement it and save this to redux as ","position":{"start":{"line":19,"column":1,"offset":1238},"end":{"line":19,"column":106,"offset":1343},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">api-to-plugins</code>","position":{"start":{"line":19,"column":106,"offset":1343},"end":{"line":19,"column":122,"offset":1359},"indent":[]}},{"type":"text","value":". This is implemented in ","position":{"start":{"line":19,"column":122,"offset":1359},"end":{"line":19,"column":147,"offset":1384},"indent":[]}},{"type":"link","title":null,"url":"https://github.com/gatsbyjs/gatsby/blob/8029c6647ab38792bb0a7c135ab4b98ae70a2627/packages/gatsby/src/bootstrap/load-plugins/validate.js#L106","children":[{"type":"text","value":"load-plugins/validate.js","position":{"start":{"line":19,"column":148,"offset":1385},"end":{"line":19,"column":172,"offset":1409},"indent":[]}}],"position":{"start":{"line":19,"column":147,"offset":1384},"end":{"line":19,"column":315,"offset":1552},"indent":[]}}],"position":{"start":{"line":19,"column":1,"offset":1238},"end":{"line":19,"column":315,"offset":1552},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"link","url":"#apiruninstance","title":null,"data":{"hProperties":{"aria-label":"apiruninstance permalink","class":"anchor"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"apiRunInstance","position":{"start":{"line":21,"column":4,"offset":1557},"end":{"line":21,"column":18,"offset":1571},"indent":[]}}],"position":{"start":{"line":21,"column":1,"offset":1554},"end":{"line":21,"column":18,"offset":1571},"indent":[]},"data":{"id":"apiruninstance","htmlAttributes":{"id":"apiruninstance"},"hProperties":{"id":"apiruninstance"}}},{"type":"paragraph","children":[{"type":"text","value":"Some API calls can take a while to finish. So every time an API is run, we create an object called ","position":{"start":{"line":23,"column":1,"offset":1573},"end":{"line":23,"column":100,"offset":1672},"indent":[]}},{"type":"link","title":null,"url":"https://github.com/gatsbyjs/gatsby/blob/8029c6647ab38792bb0a7c135ab4b98ae70a2627/packages/gatsby/src/utils/api-runner-node.js#L179","children":[{"type":"text","value":"apiRunInstance","position":{"start":{"line":23,"column":101,"offset":1673},"end":{"line":23,"column":115,"offset":1687},"indent":[]}}],"position":{"start":{"line":23,"column":100,"offset":1672},"end":{"line":23,"column":248,"offset":1820},"indent":[]}},{"type":"text","value":" to track it. It contains the following notable fields:","position":{"start":{"line":23,"column":248,"offset":1820},"end":{"line":23,"column":303,"offset":1875},"indent":[]}}],"position":{"start":{"line":23,"column":1,"offset":1573},"end":{"line":23,"column":303,"offset":1875},"indent":[]}},{"type":"list","ordered":false,"start":null,"loose":false,"children":[{"type":"listItem","loose":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"id","position":{"start":{"line":25,"column":5,"offset":1881},"end":{"line":25,"column":7,"offset":1883},"indent":[]}}],"position":{"start":{"line":25,"column":3,"offset":1879},"end":{"line":25,"column":9,"offset":1885},"indent":[]}},{"type":"text","value":": Unique identifier generated based on type of API","position":{"start":{"line":25,"column":9,"offset":1885},"end":{"line":25,"column":59,"offset":1935},"indent":[]}}],"position":{"start":{"line":25,"column":3,"offset":1879},"end":{"line":25,"column":59,"offset":1935},"indent":[]}}],"position":{"start":{"line":25,"column":1,"offset":1877},"end":{"line":25,"column":59,"offset":1935},"indent":[]}},{"type":"listItem","loose":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"api","position":{"start":{"line":26,"column":5,"offset":1940},"end":{"line":26,"column":8,"offset":1943},"indent":[]}}],"position":{"start":{"line":26,"column":3,"offset":1938},"end":{"line":26,"column":10,"offset":1945},"indent":[]}},{"type":"text","value":": The API we’re running. E.g ","position":{"start":{"line":26,"column":10,"offset":1945},"end":{"line":26,"column":39,"offset":1974},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">onCreateNode</code>","position":{"start":{"line":26,"column":39,"offset":1974},"end":{"line":26,"column":53,"offset":1988},"indent":[]}}],"position":{"start":{"line":26,"column":3,"offset":1938},"end":{"line":26,"column":53,"offset":1988},"indent":[]}}],"position":{"start":{"line":26,"column":1,"offset":1936},"end":{"line":26,"column":53,"offset":1988},"indent":[]}},{"type":"listItem","loose":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"args","position":{"start":{"line":27,"column":5,"offset":1993},"end":{"line":27,"column":9,"offset":1997},"indent":[]}}],"position":{"start":{"line":27,"column":3,"offset":1991},"end":{"line":27,"column":11,"offset":1999},"indent":[]}},{"type":"text","value":": Any arguments passed to ","position":{"start":{"line":27,"column":11,"offset":1999},"end":{"line":27,"column":37,"offset":2025},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">api-runner-node</code>","position":{"start":{"line":27,"column":37,"offset":2025},"end":{"line":27,"column":54,"offset":2042},"indent":[]}},{"type":"text","value":". E.g a node object","position":{"start":{"line":27,"column":54,"offset":2042},"end":{"line":27,"column":73,"offset":2061},"indent":[]}}],"position":{"start":{"line":27,"column":3,"offset":1991},"end":{"line":27,"column":73,"offset":2061},"indent":[]}}],"position":{"start":{"line":27,"column":1,"offset":1989},"end":{"line":27,"column":73,"offset":2061},"indent":[]}},{"type":"listItem","loose":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"pluginSource","position":{"start":{"line":28,"column":5,"offset":2066},"end":{"line":28,"column":17,"offset":2078},"indent":[]}}],"position":{"start":{"line":28,"column":3,"offset":2064},"end":{"line":28,"column":19,"offset":2080},"indent":[]}},{"type":"text","value":": optional name of the plugin that initiated the original call","position":{"start":{"line":28,"column":19,"offset":2080},"end":{"line":28,"column":81,"offset":2142},"indent":[]}}],"position":{"start":{"line":28,"column":3,"offset":2064},"end":{"line":28,"column":81,"offset":2142},"indent":[]}}],"position":{"start":{"line":28,"column":1,"offset":2062},"end":{"line":28,"column":81,"offset":2142},"indent":[]}},{"type":"listItem","loose":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"resolve","position":{"start":{"line":29,"column":5,"offset":2147},"end":{"line":29,"column":12,"offset":2154},"indent":[]}}],"position":{"start":{"line":29,"column":3,"offset":2145},"end":{"line":29,"column":14,"offset":2156},"indent":[]}},{"type":"text","value":": promise resolve callback to be called when the API has finished running","position":{"start":{"line":29,"column":14,"offset":2156},"end":{"line":29,"column":87,"offset":2229},"indent":[]}}],"position":{"start":{"line":29,"column":3,"offset":2145},"end":{"line":29,"column":87,"offset":2229},"indent":[]}}],"position":{"start":{"line":29,"column":1,"offset":2143},"end":{"line":29,"column":87,"offset":2229},"indent":[]}},{"type":"listItem","loose":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"startTime","position":{"start":{"line":30,"column":5,"offset":2234},"end":{"line":30,"column":14,"offset":2243},"indent":[]}}],"position":{"start":{"line":30,"column":3,"offset":2232},"end":{"line":30,"column":16,"offset":2245},"indent":[]}},{"type":"text","value":": time that the API run was started","position":{"start":{"line":30,"column":16,"offset":2245},"end":{"line":30,"column":51,"offset":2280},"indent":[]}}],"position":{"start":{"line":30,"column":3,"offset":2232},"end":{"line":30,"column":51,"offset":2280},"indent":[]}}],"position":{"start":{"line":30,"column":1,"offset":2230},"end":{"line":30,"column":51,"offset":2280},"indent":[]}},{"type":"listItem","loose":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"span","position":{"start":{"line":31,"column":5,"offset":2285},"end":{"line":31,"column":9,"offset":2289},"indent":[]}}],"position":{"start":{"line":31,"column":3,"offset":2283},"end":{"line":31,"column":11,"offset":2291},"indent":[]}},{"type":"text","value":": opentracing span for tracing builds","position":{"start":{"line":31,"column":11,"offset":2291},"end":{"line":31,"column":48,"offset":2328},"indent":[]}}],"position":{"start":{"line":31,"column":3,"offset":2283},"end":{"line":31,"column":48,"offset":2328},"indent":[]}}],"position":{"start":{"line":31,"column":1,"offset":2281},"end":{"line":31,"column":48,"offset":2328},"indent":[]}},{"type":"listItem","loose":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"traceId","position":{"start":{"line":32,"column":5,"offset":2333},"end":{"line":32,"column":12,"offset":2340},"indent":[]}}],"position":{"start":{"line":32,"column":3,"offset":2331},"end":{"line":32,"column":14,"offset":2342},"indent":[]}},{"type":"text","value":": optional args.traceId provided if API will result in further API calls (","position":{"start":{"line":32,"column":14,"offset":2342},"end":{"line":32,"column":88,"offset":2416},"indent":[]}},{"type":"link","title":null,"url":"#using-traceid-to-await-downstream-api-calls","children":[{"type":"text","value":"see below","position":{"start":{"line":32,"column":89,"offset":2417},"end":{"line":32,"column":98,"offset":2426},"indent":[]}}],"position":{"start":{"line":32,"column":88,"offset":2416},"end":{"line":32,"column":145,"offset":2473},"indent":[]}},{"type":"text","value":")","position":{"start":{"line":32,"column":145,"offset":2473},"end":{"line":32,"column":146,"offset":2474},"indent":[]}}],"position":{"start":{"line":32,"column":3,"offset":2331},"end":{"line":32,"column":146,"offset":2474},"indent":[]}}],"position":{"start":{"line":32,"column":1,"offset":2329},"end":{"line":32,"column":146,"offset":2474},"indent":[]}}],"position":{"start":{"line":25,"column":1,"offset":1877},"end":{"line":32,"column":146,"offset":2474},"indent":[1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"We immediately place this object into an ","position":{"start":{"line":34,"column":1,"offset":2476},"end":{"line":34,"column":42,"offset":2517},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">apisRunningById</code>","position":{"start":{"line":34,"column":42,"offset":2517},"end":{"line":34,"column":59,"offset":2534},"indent":[]}},{"type":"text","value":" Map, where we track its execution.","position":{"start":{"line":34,"column":59,"offset":2534},"end":{"line":34,"column":94,"offset":2569},"indent":[]}}],"position":{"start":{"line":34,"column":1,"offset":2476},"end":{"line":34,"column":94,"offset":2569},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"link","url":"#running-each-plugin","title":null,"data":{"hProperties":{"aria-label":"running each plugin permalink","class":"anchor"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"Running each plugin","position":{"start":{"line":36,"column":4,"offset":2574},"end":{"line":36,"column":23,"offset":2593},"indent":[]}}],"position":{"start":{"line":36,"column":1,"offset":2571},"end":{"line":36,"column":23,"offset":2593},"indent":[]},"data":{"id":"running-each-plugin","htmlAttributes":{"id":"running-each-plugin"},"hProperties":{"id":"running-each-plugin"}}},{"type":"paragraph","children":[{"type":"text","value":"Next, we filter all ","position":{"start":{"line":38,"column":1,"offset":2595},"end":{"line":38,"column":21,"offset":2615},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">flattenedPlugins</code>","position":{"start":{"line":38,"column":21,"offset":2615},"end":{"line":38,"column":39,"offset":2633},"indent":[]}},{"type":"text","value":" down to those that implement the API we’re trying to run. For each plugin, we require its ","position":{"start":{"line":38,"column":39,"offset":2633},"end":{"line":38,"column":130,"offset":2724},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">gatsby-node.js</code>","position":{"start":{"line":38,"column":130,"offset":2724},"end":{"line":38,"column":146,"offset":2740},"indent":[]}},{"type":"text","value":" and call its exported API function. E.g if API was ","position":{"start":{"line":38,"column":146,"offset":2740},"end":{"line":38,"column":198,"offset":2792},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">sourceNodes</code>","position":{"start":{"line":38,"column":198,"offset":2792},"end":{"line":38,"column":211,"offset":2805},"indent":[]}},{"type":"text","value":", it would result in a call to ","position":{"start":{"line":38,"column":211,"offset":2805},"end":{"line":38,"column":242,"offset":2836},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">gatsbyNode[&#39;sourceNodes&#39;](...apiCallargs)</code>","position":{"start":{"line":38,"column":242,"offset":2836},"end":{"line":38,"column":285,"offset":2879},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":38,"column":285,"offset":2879},"end":{"line":38,"column":286,"offset":2880},"indent":[]}}],"position":{"start":{"line":38,"column":1,"offset":2595},"end":{"line":38,"column":286,"offset":2880},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"link","url":"#injected-arguments","title":null,"data":{"hProperties":{"aria-label":"injected arguments permalink","class":"anchor"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"Injected arguments","position":{"start":{"line":40,"column":4,"offset":2885},"end":{"line":40,"column":22,"offset":2903},"indent":[]}}],"position":{"start":{"line":40,"column":1,"offset":2882},"end":{"line":40,"column":22,"offset":2903},"indent":[]},"data":{"id":"injected-arguments","htmlAttributes":{"id":"injected-arguments"},"hProperties":{"id":"injected-arguments"}}},{"type":"paragraph","children":[{"type":"text","value":"API implementations are passed a variety of useful ","position":{"start":{"line":42,"column":1,"offset":2905},"end":{"line":42,"column":52,"offset":2956},"indent":[]}},{"type":"link","title":null,"url":"/docs/actions/","children":[{"type":"text","value":"actions","position":{"start":{"line":42,"column":53,"offset":2957},"end":{"line":42,"column":60,"offset":2964},"indent":[]}}],"position":{"start":{"line":42,"column":52,"offset":2956},"end":{"line":42,"column":77,"offset":2981},"indent":[]}},{"type":"text","value":" and other interesting functions/objects. These arguments are ","position":{"start":{"line":42,"column":77,"offset":2981},"end":{"line":42,"column":139,"offset":3043},"indent":[]}},{"type":"link","title":null,"url":"https://github.com/gatsbyjs/gatsby/blob/8029c6647ab38792bb0a7c135ab4b98ae70a2627/packages/gatsby/src/utils/api-runner-node.js#L94","children":[{"type":"text","value":"created","position":{"start":{"line":42,"column":140,"offset":3044},"end":{"line":42,"column":147,"offset":3051},"indent":[]}}],"position":{"start":{"line":42,"column":139,"offset":3043},"end":{"line":42,"column":279,"offset":3183},"indent":[]}},{"type":"text","value":" each time a plugin is run for an API, which allows us to rebind actions with default information.","position":{"start":{"line":42,"column":279,"offset":3183},"end":{"line":42,"column":377,"offset":3281},"indent":[]}}],"position":{"start":{"line":42,"column":1,"offset":2905},"end":{"line":42,"column":377,"offset":3281},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"All actions take 3 arguments:","position":{"start":{"line":44,"column":1,"offset":3283},"end":{"line":44,"column":30,"offset":3312},"indent":[]}}],"position":{"start":{"line":44,"column":1,"offset":3283},"end":{"line":44,"column":30,"offset":3312},"indent":[]}},{"type":"list","ordered":true,"start":1,"loose":false,"children":[{"type":"listItem","loose":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"The core information required by the action. E.g for ","position":{"start":{"line":46,"column":5,"offset":3318},"end":{"line":46,"column":58,"offset":3371},"indent":[]}},{"type":"link","title":null,"url":"/docs/actions/#createNode","children":[{"type":"text","value":"createNode","position":{"start":{"line":46,"column":59,"offset":3372},"end":{"line":46,"column":69,"offset":3382},"indent":[]}}],"position":{"start":{"line":46,"column":58,"offset":3371},"end":{"line":46,"column":97,"offset":3410},"indent":[]}},{"type":"text","value":", we must pass a node","position":{"start":{"line":46,"column":97,"offset":3410},"end":{"line":46,"column":118,"offset":3431},"indent":[]}}],"position":{"start":{"line":46,"column":5,"offset":3318},"end":{"line":46,"column":118,"offset":3431},"indent":[]}}],"position":{"start":{"line":46,"column":1,"offset":3314},"end":{"line":46,"column":118,"offset":3431},"indent":[]}},{"type":"listItem","loose":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"The plugin that is calling this action. E.g ","position":{"start":{"line":47,"column":5,"offset":3436},"end":{"line":47,"column":49,"offset":3480},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">createNode</code>","position":{"start":{"line":47,"column":49,"offset":3480},"end":{"line":47,"column":61,"offset":3492},"indent":[]}},{"type":"text","value":" uses this to assign the owner of the new node","position":{"start":{"line":47,"column":61,"offset":3492},"end":{"line":47,"column":107,"offset":3538},"indent":[]}}],"position":{"start":{"line":47,"column":5,"offset":3436},"end":{"line":47,"column":107,"offset":3538},"indent":[]}}],"position":{"start":{"line":47,"column":1,"offset":3432},"end":{"line":47,"column":107,"offset":3538},"indent":[]}},{"type":"listItem","loose":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"An object with misc action options:","position":{"start":{"line":48,"column":5,"offset":3543},"end":{"line":48,"column":40,"offset":3578},"indent":[]}}],"position":{"start":{"line":48,"column":5,"offset":3543},"end":{"line":48,"column":40,"offset":3578},"indent":[]}},{"type":"list","ordered":false,"start":null,"loose":false,"children":[{"type":"listItem","loose":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"traceId","position":{"start":{"line":49,"column":9,"offset":3587},"end":{"line":49,"column":16,"offset":3594},"indent":[]}}],"position":{"start":{"line":49,"column":7,"offset":3585},"end":{"line":49,"column":18,"offset":3596},"indent":[]}},{"type":"text","value":": ","position":{"start":{"line":49,"column":18,"offset":3596},"end":{"line":49,"column":20,"offset":3598},"indent":[]}},{"type":"link","title":null,"url":"#using-traceid-to-await-downstream-api-calls","children":[{"type":"text","value":"See below","position":{"start":{"line":49,"column":21,"offset":3599},"end":{"line":49,"column":30,"offset":3608},"indent":[]}}],"position":{"start":{"line":49,"column":20,"offset":3598},"end":{"line":49,"column":77,"offset":3655},"indent":[]}}],"position":{"start":{"line":49,"column":7,"offset":3585},"end":{"line":49,"column":77,"offset":3655},"indent":[]}}],"position":{"start":{"line":49,"column":5,"offset":3583},"end":{"line":49,"column":77,"offset":3655},"indent":[]}},{"type":"listItem","loose":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"parentSpan","position":{"start":{"line":50,"column":9,"offset":3664},"end":{"line":50,"column":19,"offset":3674},"indent":[]}}],"position":{"start":{"line":50,"column":7,"offset":3662},"end":{"line":50,"column":21,"offset":3676},"indent":[]}},{"type":"text","value":": opentracing span (see ","position":{"start":{"line":50,"column":21,"offset":3676},"end":{"line":50,"column":45,"offset":3700},"indent":[]}},{"type":"link","title":null,"url":"/docs/performance-tracing/","children":[{"type":"text","value":"tracing docs","position":{"start":{"line":50,"column":46,"offset":3701},"end":{"line":50,"column":58,"offset":3713},"indent":[]}}],"position":{"start":{"line":50,"column":45,"offset":3700},"end":{"line":50,"column":87,"offset":3742},"indent":[]}},{"type":"text","value":")","position":{"start":{"line":50,"column":87,"offset":3742},"end":{"line":50,"column":88,"offset":3743},"indent":[]}}],"position":{"start":{"line":50,"column":7,"offset":3662},"end":{"line":50,"column":88,"offset":3743},"indent":[]}}],"position":{"start":{"line":50,"column":5,"offset":3660},"end":{"line":50,"column":88,"offset":3743},"indent":[]}}],"position":{"start":{"line":49,"column":5,"offset":3583},"end":{"line":50,"column":88,"offset":3743},"indent":[5]}}],"position":{"start":{"line":48,"column":1,"offset":3539},"end":{"line":50,"column":88,"offset":3743},"indent":[1,1]}}],"position":{"start":{"line":46,"column":1,"offset":3314},"end":{"line":50,"column":88,"offset":3743},"indent":[1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Passing the plugin and action options on every single action call would be extremely painful for plugin/site authors. Since we know the plugin, traceId and parentSpan when we’re running our API, we can rebind injected actions so these arguments are already provided. This is done in the ","position":{"start":{"line":52,"column":1,"offset":3745},"end":{"line":52,"column":288,"offset":4032},"indent":[]}},{"type":"link","title":null,"url":"https://github.com/gatsbyjs/gatsby/blob/8029c6647ab38792bb0a7c135ab4b98ae70a2627/packages/gatsby/src/utils/api-runner-node.js#L14","children":[{"type":"text","value":"doubleBind","position":{"start":{"line":52,"column":289,"offset":4033},"end":{"line":52,"column":299,"offset":4043},"indent":[]}}],"position":{"start":{"line":52,"column":288,"offset":4032},"end":{"line":52,"column":431,"offset":4175},"indent":[]}},{"type":"text","value":" step.","position":{"start":{"line":52,"column":431,"offset":4175},"end":{"line":52,"column":437,"offset":4181},"indent":[]}}],"position":{"start":{"line":52,"column":1,"offset":3745},"end":{"line":52,"column":437,"offset":4181},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"link","url":"#waiting-for-all-plugins-to-run","title":null,"data":{"hProperties":{"aria-label":"waiting for all plugins to run permalink","class":"anchor"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"Waiting for all plugins to run","position":{"start":{"line":54,"column":4,"offset":4186},"end":{"line":54,"column":34,"offset":4216},"indent":[]}}],"position":{"start":{"line":54,"column":1,"offset":4183},"end":{"line":54,"column":34,"offset":4216},"indent":[]},"data":{"id":"waiting-for-all-plugins-to-run","htmlAttributes":{"id":"waiting-for-all-plugins-to-run"},"hProperties":{"id":"waiting-for-all-plugins-to-run"}}},{"type":"paragraph","children":[{"type":"text","value":"Each plugin is run inside a ","position":{"start":{"line":56,"column":1,"offset":4218},"end":{"line":56,"column":29,"offset":4246},"indent":[]}},{"type":"link","title":null,"url":"https://www.npmjs.com/package/map-series","children":[{"type":"text","value":"map-series","position":{"start":{"line":56,"column":30,"offset":4247},"end":{"line":56,"column":40,"offset":4257},"indent":[]}}],"position":{"start":{"line":56,"column":29,"offset":4246},"end":{"line":56,"column":83,"offset":4300},"indent":[]}},{"type":"text","value":" promise, which allows them to be executed concurrently. Once all plugins have finished running, we remove them from ","position":{"start":{"line":56,"column":83,"offset":4300},"end":{"line":56,"column":200,"offset":4417},"indent":[]}},{"type":"link","title":null,"url":"https://github.com/gatsbyjs/gatsby/blob/8029c6647ab38792bb0a7c135ab4b98ae70a2627/packages/gatsby/src/utils/api-runner-node.js#L246","children":[{"type":"text","value":"apisRunningById","position":{"start":{"line":56,"column":201,"offset":4418},"end":{"line":56,"column":216,"offset":4433},"indent":[]}}],"position":{"start":{"line":56,"column":200,"offset":4417},"end":{"line":56,"column":349,"offset":4566},"indent":[]}},{"type":"text","value":" and fire a ","position":{"start":{"line":56,"column":349,"offset":4566},"end":{"line":56,"column":361,"offset":4578},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">API_RUNNING_QUEUE_EMPTY</code>","position":{"start":{"line":56,"column":361,"offset":4578},"end":{"line":56,"column":386,"offset":4603},"indent":[]}},{"type":"text","value":" event. This in turn, results in any dirty pages being recreated, as well as their queries. Finally, the results are returned.","position":{"start":{"line":56,"column":386,"offset":4603},"end":{"line":56,"column":512,"offset":4729},"indent":[]}}],"position":{"start":{"line":56,"column":1,"offset":4218},"end":{"line":56,"column":512,"offset":4729},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"link","url":"#using-traceid-to-await-downstream-api-calls","title":null,"data":{"hProperties":{"aria-label":"using traceid to await downstream api calls permalink","class":"anchor"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"Using traceID to await downstream API calls","position":{"start":{"line":58,"column":4,"offset":4734},"end":{"line":58,"column":47,"offset":4777},"indent":[]}}],"position":{"start":{"line":58,"column":1,"offset":4731},"end":{"line":58,"column":47,"offset":4777},"indent":[]},"data":{"id":"using-traceid-to-await-downstream-api-calls","htmlAttributes":{"id":"using-traceid-to-await-downstream-api-calls"},"hProperties":{"id":"using-traceid-to-await-downstream-api-calls"}}},{"type":"paragraph","children":[{"type":"text","value":"The majority of API calls result in one or more implementing plugins being called. We then wait for them all to complete, and return. But some plugins (e.g ","position":{"start":{"line":60,"column":1,"offset":4779},"end":{"line":60,"column":157,"offset":4935},"indent":[]}},{"type":"link","title":null,"url":"/docs/node-apis/#sourceNodes","children":[{"type":"text","value":"sourceNodes","position":{"start":{"line":60,"column":158,"offset":4936},"end":{"line":60,"column":169,"offset":4947},"indent":[]}}],"position":{"start":{"line":60,"column":157,"offset":4935},"end":{"line":60,"column":200,"offset":4978},"indent":[]}},{"type":"text","value":") result in calls to actions that themselves call APIs. We need some way of tracing whether an API call originated from another API call, so that we can wait on all child calls to complete. The mechanism for this is the ","position":{"start":{"line":60,"column":200,"offset":4978},"end":{"line":60,"column":420,"offset":5198},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">traceId</code>","position":{"start":{"line":60,"column":420,"offset":5198},"end":{"line":60,"column":429,"offset":5207},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":60,"column":429,"offset":5207},"end":{"line":60,"column":430,"offset":5208},"indent":[]}}],"position":{"start":{"line":60,"column":1,"offset":4779},"end":{"line":60,"column":430,"offset":5208},"indent":[]}},{"type":"html","lang":"dot","value":"<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<!-- Generated by graphviz version 2.40.1 (20161225.0304)\n -->\n<!-- Title: %0 Pages: 1 -->\n<svg width=\"406pt\" height=\"925pt\"\n viewBox=\"0.00 0.00 406.29 924.60\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 920.6)\">\n<title>%0</title>\n<polygon fill=\"#ffffff\" stroke=\"transparent\" points=\"-4,4 -4,-920.6 402.2915,-920.6 402.2915,4 -4,4\"/>\n<!-- initialCall -->\n<g id=\"node1\" class=\"node\">\n<title>initialCall</title>\n<polygon fill=\"none\" stroke=\"#000000\" points=\"355.9521,-916.5002 147.8229,-916.5002 147.8229,-807.8998 355.9521,-807.8998 355.9521,-916.5002\"/>\n<text text-anchor=\"start\" x=\"155.8552\" y=\"-900\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">apiRunner(`sourceNodes`, {</text>\n<text text-anchor=\"start\" x=\"155.8552\" y=\"-883.2\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\"> &#160;&#160;&#160;traceId: `initial&#45;sourceNodes`,</text>\n<text text-anchor=\"start\" x=\"155.8552\" y=\"-866.4\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\"> &#160;&#160;&#160;waitForCascadingActions: true,</text>\n<text text-anchor=\"start\" x=\"155.8552\" y=\"-849.6\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\"> &#160;&#160;&#160;parentSpan: parentSpan</text>\n<text text-anchor=\"start\" x=\"155.8552\" y=\"-832.8\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">})</text>\n<text text-anchor=\"middle\" x=\"251.8875\" y=\"-816\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\"> </text>\n</g>\n<!-- apiRunner1 -->\n<g id=\"node2\" class=\"node\">\n<title>apiRunner1</title>\n<polygon fill=\"none\" stroke=\"#000000\" points=\"311.3995,-770.8 192.3755,-770.8 192.3755,-734.8 311.3995,-734.8 311.3995,-770.8\"/>\n<text text-anchor=\"middle\" x=\"251.8875\" y=\"-748.6\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">api&#45;runner&#45;node.js</text>\n</g>\n<!-- initialCall&#45;&gt;apiRunner1 -->\n<g id=\"edge1\" class=\"edge\">\n<title>initialCall&#45;&gt;apiRunner1</title>\n<path fill=\"none\" stroke=\"#000000\" d=\"M251.8875,-807.8205C251.8875,-798.5734 251.8875,-789.3141 251.8875,-781.0997\"/>\n<polygon fill=\"#000000\" stroke=\"#000000\" points=\"255.3876,-780.9918 251.8875,-770.9918 248.3876,-780.9919 255.3876,-780.9918\"/>\n</g>\n<!-- sourceNodes -->\n<g id=\"node3\" class=\"node\">\n<title>sourceNodes</title>\n<polygon fill=\"none\" stroke=\"#000000\" points=\"211.6283,-682 72.1467,-682 72.1467,-646 211.6283,-646 211.6283,-682\"/>\n<text text-anchor=\"middle\" x=\"141.8875\" y=\"-659.8\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">plugin.SourceNodes()</text>\n</g>\n<!-- apiRunner1&#45;&gt;sourceNodes -->\n<g id=\"edge3\" class=\"edge\">\n<title>apiRunner1&#45;&gt;sourceNodes</title>\n<path fill=\"none\" stroke=\"#000000\" d=\"M229.3619,-734.6157C212.9007,-721.327 190.3929,-703.1571 172.3311,-688.5763\"/>\n<polygon fill=\"#000000\" stroke=\"#000000\" points=\"174.3625,-685.718 164.383,-682.16 169.9655,-691.1648 174.3625,-685.718\"/>\n<text text-anchor=\"middle\" x=\"215.9927\" y=\"-704.2\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">call</text>\n</g>\n<!-- apisRunning -->\n<g id=\"node5\" class=\"node\">\n<title>apisRunning</title>\n<polygon fill=\"none\" stroke=\"#000000\" points=\"398.1956,-36 203.5794,-36 203.5794,0 398.1956,0 398.1956,-36\"/>\n<text text-anchor=\"middle\" x=\"300.8875\" y=\"-13.8\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">apisRunningByTraceId[traceId]</text>\n</g>\n<!-- apiRunner1&#45;&gt;apisRunning -->\n<g id=\"edge2\" class=\"edge\">\n<title>apiRunner1&#45;&gt;apisRunning</title>\n<path fill=\"none\" stroke=\"#000000\" d=\"M269.0253,-734.6564C283.1555,-717.743 300.8875,-691.1163 300.8875,-664 300.8875,-664 300.8875,-664 300.8875,-106.8 300.8875,-86.5006 300.8875,-63.591 300.8875,-46.1264\"/>\n<polygon fill=\"#000000\" stroke=\"#000000\" points=\"304.3876,-46.0279 300.8875,-36.0279 297.3876,-46.0279 304.3876,-46.0279\"/>\n<text text-anchor=\"middle\" x=\"321.1077\" y=\"-393.4\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">set to 1</text>\n</g>\n<!-- createNode -->\n<g id=\"node4\" class=\"node\">\n<title>createNode</title>\n<polygon fill=\"none\" stroke=\"#000000\" points=\"139.1544,-593.2 22.6206,-593.2 22.6206,-557.2 139.1544,-557.2 139.1544,-593.2\"/>\n<text text-anchor=\"middle\" x=\"80.8875\" y=\"-571\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">createNode(node)</text>\n</g>\n<!-- sourceNodes&#45;&gt;createNode -->\n<g id=\"edge4\" class=\"edge\">\n<title>sourceNodes&#45;&gt;createNode</title>\n<path fill=\"none\" stroke=\"#000000\" d=\"M98.8308,-645.8831C91.9695,-641.0818 85.7778,-635.1773 81.6377,-628 77.4507,-620.7413 76.158,-611.9347 76.2266,-603.611\"/>\n<polygon fill=\"#000000\" stroke=\"#000000\" points=\"79.729,-603.6961 76.9261,-593.4787 72.7456,-603.2139 79.729,-603.6961\"/>\n<text text-anchor=\"middle\" x=\"184.5124\" y=\"-615.4\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">call (traceID passed via doubleBind)</text>\n</g>\n<!-- createNodeReducer -->\n<g id=\"node6\" class=\"node\">\n<title>createNodeReducer</title>\n<polygon fill=\"none\" stroke=\"#000000\" points=\"161.6627,-504.4 .1123,-504.4 .1123,-468.4 161.6627,-468.4 161.6627,-504.4\"/>\n<text text-anchor=\"middle\" x=\"80.8875\" y=\"-482.2\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">CREATE_NODE reducer</text>\n</g>\n<!-- createNode&#45;&gt;createNodeReducer -->\n<g id=\"edge5\" class=\"edge\">\n<title>createNode&#45;&gt;createNodeReducer</title>\n<path fill=\"none\" stroke=\"#000000\" d=\"M80.8875,-556.8006C80.8875,-544.6949 80.8875,-528.6076 80.8875,-514.8674\"/>\n<polygon fill=\"#000000\" stroke=\"#000000\" points=\"84.3876,-514.472 80.8875,-504.472 77.3876,-514.4721 84.3876,-514.472\"/>\n<text text-anchor=\"middle\" x=\"158.0415\" y=\"-526.6\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">triggers (action has traceId)</text>\n</g>\n<!-- CREATE_NODE -->\n<g id=\"node7\" class=\"node\">\n<title>CREATE_NODE</title>\n<polygon fill=\"none\" stroke=\"#000000\" points=\"156.0174,-415.6 5.7576,-415.6 5.7576,-379.6 156.0174,-379.6 156.0174,-415.6\"/>\n<text text-anchor=\"middle\" x=\"80.8875\" y=\"-393.4\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">CREATE_NODE event</text>\n</g>\n<!-- createNodeReducer&#45;&gt;CREATE_NODE -->\n<g id=\"edge6\" class=\"edge\">\n<title>createNodeReducer&#45;&gt;CREATE_NODE</title>\n<path fill=\"none\" stroke=\"#000000\" d=\"M80.8875,-468.0006C80.8875,-455.8949 80.8875,-439.8076 80.8875,-426.0674\"/>\n<polygon fill=\"#000000\" stroke=\"#000000\" points=\"84.3876,-425.672 80.8875,-415.672 77.3876,-425.6721 84.3876,-425.672\"/>\n<text text-anchor=\"middle\" x=\"149.8809\" y=\"-437.8\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">emits (event has traceId)</text>\n</g>\n<!-- pluginRunner -->\n<g id=\"node8\" class=\"node\">\n<title>pluginRunner</title>\n<polygon fill=\"none\" stroke=\"#000000\" points=\"136.7005,-326.8 31.0745,-326.8 31.0745,-290.8 136.7005,-290.8 136.7005,-326.8\"/>\n<text text-anchor=\"middle\" x=\"83.8875\" y=\"-304.6\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">plugin&#45;runner.js</text>\n</g>\n<!-- CREATE_NODE&#45;&gt;pluginRunner -->\n<g id=\"edge7\" class=\"edge\">\n<title>CREATE_NODE&#45;&gt;pluginRunner</title>\n<path fill=\"none\" stroke=\"#000000\" d=\"M81.5091,-379.2006C81.9181,-367.0949 82.4616,-351.0076 82.9258,-337.2674\"/>\n<polygon fill=\"#000000\" stroke=\"#000000\" points=\"86.4372,-336.9845 83.277,-326.872 79.4412,-336.7481 86.4372,-336.9845\"/>\n<text text-anchor=\"middle\" x=\"167.6253\" y=\"-349\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">handled by (event has traceId)</text>\n</g>\n<!-- apiRunnerOnCreateNode -->\n<g id=\"node10\" class=\"node\">\n<title>apiRunnerOnCreateNode</title>\n<polygon fill=\"none\" stroke=\"#000000\" points=\"187.2577,-253.8 4.5173,-253.8 4.5173,-161.8 187.2577,-161.8 187.2577,-253.8\"/>\n<text text-anchor=\"start\" x=\"12.4524\" y=\"-237.2\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">apiRunner(`onCreateNode`, {</text>\n<text text-anchor=\"start\" x=\"12.4524\" y=\"-220.4\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\"> &#160;&#160;&#160;node,</text>\n<text text-anchor=\"start\" x=\"12.4524\" y=\"-203.6\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\"> &#160;&#160;&#160;traceId: action.traceId</text>\n<text text-anchor=\"start\" x=\"12.4524\" y=\"-186.8\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">})</text>\n<text text-anchor=\"middle\" x=\"95.8875\" y=\"-170\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\"> </text>\n</g>\n<!-- pluginRunner&#45;&gt;apiRunnerOnCreateNode -->\n<g id=\"edge8\" class=\"edge\">\n<title>pluginRunner&#45;&gt;apiRunnerOnCreateNode</title>\n<path fill=\"none\" stroke=\"#000000\" d=\"M86.0329,-290.7432C86.9435,-283.0788 88.0595,-273.6854 89.2092,-264.0087\"/>\n<polygon fill=\"#000000\" stroke=\"#000000\" points=\"92.708,-264.2259 90.4123,-253.8827 85.7569,-263.3999 92.708,-264.2259\"/>\n</g>\n<!-- onCreateNode -->\n<g id=\"node9\" class=\"node\">\n<title>onCreateNode</title>\n<polygon fill=\"none\" stroke=\"#000000\" points=\"185.8434,-36 39.9316,-36 39.9316,0 185.8434,0 185.8434,-36\"/>\n<text text-anchor=\"middle\" x=\"112.8875\" y=\"-13.8\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">plugin.onCreateNode()</text>\n</g>\n<!-- apiRunner2 -->\n<g id=\"node11\" class=\"node\">\n<title>apiRunner2</title>\n<polygon fill=\"none\" stroke=\"#000000\" points=\"172.3995,-124.8 53.3755,-124.8 53.3755,-88.8 172.3995,-88.8 172.3995,-124.8\"/>\n<text text-anchor=\"middle\" x=\"112.8875\" y=\"-102.6\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">api&#45;runner&#45;node.js</text>\n</g>\n<!-- apiRunnerOnCreateNode&#45;&gt;apiRunner2 -->\n<g id=\"edge9\" class=\"edge\">\n<title>apiRunnerOnCreateNode&#45;&gt;apiRunner2</title>\n<path fill=\"none\" stroke=\"#000000\" d=\"M103.6413,-161.7334C105.1513,-152.762 106.693,-143.6026 108.0737,-135.3994\"/>\n<polygon fill=\"#000000\" stroke=\"#000000\" points=\"111.5715,-135.7048 109.7799,-125.2625 104.6686,-134.5429 111.5715,-135.7048\"/>\n</g>\n<!-- apiRunner2&#45;&gt;apisRunning -->\n<g id=\"edge11\" class=\"edge\">\n<title>apiRunner2&#45;&gt;apisRunning</title>\n<path fill=\"none\" stroke=\"#000000\" d=\"M151.3858,-88.6157C181.0113,-74.6224 222.096,-55.2164 253.7004,-40.2884\"/>\n<polygon fill=\"#000000\" stroke=\"#000000\" points=\"255.2152,-43.4438 262.7624,-36.008 252.2255,-37.1143 255.2152,-43.4438\"/>\n<text text-anchor=\"middle\" x=\"250.8756\" y=\"-58.2\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">increment</text>\n</g>\n<!-- apiRunner2&#45;&gt;onCreateNode -->\n<g id=\"edge10\" class=\"edge\">\n<title>apiRunner2&#45;&gt;onCreateNode</title>\n<path fill=\"none\" stroke=\"#000000\" d=\"M112.8875,-88.4006C112.8875,-76.2949 112.8875,-60.2076 112.8875,-46.4674\"/>\n<polygon fill=\"#000000\" stroke=\"#000000\" points=\"116.3876,-46.072 112.8875,-36.072 109.3876,-46.0721 116.3876,-46.072\"/>\n<text text-anchor=\"middle\" x=\"122.9927\" y=\"-58.2\" font-family=\"Times,serif\" font-size=\"14.00\" fill=\"#000000\">call</text>\n</g>\n</g>\n</svg>\n","position":{"start":{"line":62,"column":1,"offset":5210},"end":{"line":90,"column":4,"offset":6636},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"list","ordered":true,"start":1,"loose":true,"children":[{"type":"listItem","loose":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"The traceID is passed as an argument to the original API runner. E.g","position":{"start":{"line":92,"column":5,"offset":6642},"end":{"line":92,"column":73,"offset":6710},"indent":[]}}],"position":{"start":{"line":92,"column":5,"offset":6642},"end":{"line":92,"column":73,"offset":6710},"indent":[]}},{"type":"html","lang":"javascript","value":"<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token function\">apiRunner</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token string\">`sourceNodes`</span></span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  traceId<span class=\"token punctuation\">:</span> <span class=\"token template-string\"><span class=\"token string\">`initial-sourceNodes`</span></span><span class=\"token punctuation\">,</span>\n  waitForCascadingActions<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  parentSpan<span class=\"token punctuation\">:</span> parentSpan<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>","position":{"start":{"line":94,"column":5,"offset":6716},"end":{"line":100,"column":8,"offset":6880},"indent":[5,5,5,5,5,5]}}],"position":{"start":{"line":92,"column":1,"offset":6638},"end":{"line":101,"column":1,"offset":6881},"indent":[1,1,1,1,1,1,1,1,1]}},{"type":"listItem","loose":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"We keep track of the number of API calls with this traceId in the ","position":{"start":{"line":102,"column":5,"offset":6886},"end":{"line":102,"column":71,"offset":6952},"indent":[]}},{"type":"link","title":null,"url":"https://github.com/gatsbyjs/gatsby/blob/8029c6647ab38792bb0a7c135ab4b98ae70a2627/packages/gatsby/src/utils/api-runner-node.js#L139","children":[{"type":"text","value":"apisRunningByTraceId","position":{"start":{"line":102,"column":72,"offset":6953},"end":{"line":102,"column":92,"offset":6973},"indent":[]}}],"position":{"start":{"line":102,"column":71,"offset":6952},"end":{"line":102,"column":225,"offset":7106},"indent":[]}},{"type":"text","value":" Map. On this first invocation, it will be set to ","position":{"start":{"line":102,"column":225,"offset":7106},"end":{"line":102,"column":275,"offset":7156},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">1</code>","position":{"start":{"line":102,"column":275,"offset":7156},"end":{"line":102,"column":278,"offset":7159},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":102,"column":278,"offset":7159},"end":{"line":102,"column":279,"offset":7160},"indent":[]}}],"position":{"start":{"line":102,"column":5,"offset":6886},"end":{"line":102,"column":279,"offset":7160},"indent":[]}}],"position":{"start":{"line":102,"column":1,"offset":6882},"end":{"line":102,"column":279,"offset":7160},"indent":[]}},{"type":"listItem","loose":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Using the action rebinding mentioned ","position":{"start":{"line":103,"column":5,"offset":7165},"end":{"line":103,"column":42,"offset":7202},"indent":[]}},{"type":"link","title":null,"url":"#injected-arguments","children":[{"type":"text","value":"above","position":{"start":{"line":103,"column":43,"offset":7203},"end":{"line":103,"column":48,"offset":7208},"indent":[]}}],"position":{"start":{"line":103,"column":42,"offset":7202},"end":{"line":103,"column":70,"offset":7230},"indent":[]}},{"type":"text","value":", the traceId is passed through to all action calls via the ","position":{"start":{"line":103,"column":70,"offset":7230},"end":{"line":103,"column":130,"offset":7290},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">actionOptions</code>","position":{"start":{"line":103,"column":130,"offset":7290},"end":{"line":103,"column":145,"offset":7305},"indent":[]}},{"type":"text","value":" object.","position":{"start":{"line":103,"column":145,"offset":7305},"end":{"line":103,"column":153,"offset":7313},"indent":[]}}],"position":{"start":{"line":103,"column":5,"offset":7165},"end":{"line":103,"column":153,"offset":7313},"indent":[]}}],"position":{"start":{"line":103,"column":1,"offset":7161},"end":{"line":103,"column":153,"offset":7313},"indent":[]}},{"type":"listItem","loose":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"After reducing the Action, a global event is ","position":{"start":{"line":104,"column":5,"offset":7318},"end":{"line":104,"column":50,"offset":7363},"indent":[]}},{"type":"link","title":null,"url":"https://github.com/gatsbyjs/gatsby/blob/8029c6647ab38792bb0a7c135ab4b98ae70a2627/packages/gatsby/src/redux/index.js#L93","children":[{"type":"text","value":"emitted","position":{"start":{"line":104,"column":51,"offset":7364},"end":{"line":104,"column":58,"offset":7371},"indent":[]}}],"position":{"start":{"line":104,"column":50,"offset":7363},"end":{"line":104,"column":180,"offset":7493},"indent":[]}},{"type":"text","value":" which includes the action information","position":{"start":{"line":104,"column":180,"offset":7493},"end":{"line":104,"column":218,"offset":7531},"indent":[]}}],"position":{"start":{"line":104,"column":5,"offset":7318},"end":{"line":104,"column":218,"offset":7531},"indent":[]}}],"position":{"start":{"line":104,"column":1,"offset":7314},"end":{"line":104,"column":218,"offset":7531},"indent":[]}},{"type":"listItem","loose":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"For the ","position":{"start":{"line":105,"column":5,"offset":7536},"end":{"line":105,"column":13,"offset":7544},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">CREATE_NODE</code>","position":{"start":{"line":105,"column":13,"offset":7544},"end":{"line":105,"column":26,"offset":7557},"indent":[]}},{"type":"text","value":" and ","position":{"start":{"line":105,"column":26,"offset":7557},"end":{"line":105,"column":31,"offset":7562},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">CREATE_PAGE</code>","position":{"start":{"line":105,"column":31,"offset":7562},"end":{"line":105,"column":44,"offset":7575},"indent":[]}},{"type":"text","value":" events, we need to call the ","position":{"start":{"line":105,"column":44,"offset":7575},"end":{"line":105,"column":73,"offset":7604},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">onCreateNode</code>","position":{"start":{"line":105,"column":73,"offset":7604},"end":{"line":105,"column":87,"offset":7618},"indent":[]}},{"type":"text","value":" and ","position":{"start":{"line":105,"column":87,"offset":7618},"end":{"line":105,"column":92,"offset":7623},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">onCreatePage</code>","position":{"start":{"line":105,"column":92,"offset":7623},"end":{"line":105,"column":106,"offset":7637},"indent":[]}},{"type":"text","value":" APIs respectively. The ","position":{"start":{"line":105,"column":106,"offset":7637},"end":{"line":105,"column":130,"offset":7661},"indent":[]}},{"type":"link","title":null,"url":"https://github.com/gatsbyjs/gatsby/blob/8029c6647ab38792bb0a7c135ab4b98ae70a2627/packages/gatsby/src/redux/plugin-runner.js","children":[{"type":"text","value":"plugin-runner","position":{"start":{"line":105,"column":131,"offset":7662},"end":{"line":105,"column":144,"offset":7675},"indent":[]}}],"position":{"start":{"line":105,"column":130,"offset":7661},"end":{"line":105,"column":270,"offset":7801},"indent":[]}},{"type":"text","value":" takes care of this. It also passes on the traceId from the Action back into the API call.","position":{"start":{"line":105,"column":270,"offset":7801},"end":{"line":105,"column":360,"offset":7891},"indent":[]}}],"position":{"start":{"line":105,"column":5,"offset":7536},"end":{"line":105,"column":360,"offset":7891},"indent":[]}}],"position":{"start":{"line":105,"column":1,"offset":7532},"end":{"line":105,"column":360,"offset":7891},"indent":[]}},{"type":"listItem","loose":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"We’re back in ","position":{"start":{"line":106,"column":5,"offset":7896},"end":{"line":106,"column":19,"offset":7910},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">api-runner-node.js</code>","position":{"start":{"line":106,"column":19,"offset":7910},"end":{"line":106,"column":39,"offset":7930},"indent":[]}},{"type":"text","value":" and can tie this new API call back to its original. So we increment the value of ","position":{"start":{"line":106,"column":39,"offset":7930},"end":{"line":106,"column":121,"offset":8012},"indent":[]}},{"type":"link","title":null,"url":"https://github.com/gatsbyjs/gatsby/blob/8029c6647ab38792bb0a7c135ab4b98ae70a2627/packages/gatsby/src/utils/api-runner-node.js#L218","children":[{"type":"text","value":"apisRunningByTraceId","position":{"start":{"line":106,"column":122,"offset":8013},"end":{"line":106,"column":142,"offset":8033},"indent":[]}}],"position":{"start":{"line":106,"column":121,"offset":8012},"end":{"line":106,"column":275,"offset":8166},"indent":[]}},{"type":"text","value":" for this traceId.","position":{"start":{"line":106,"column":275,"offset":8166},"end":{"line":106,"column":293,"offset":8184},"indent":[]}}],"position":{"start":{"line":106,"column":5,"offset":7896},"end":{"line":106,"column":293,"offset":8184},"indent":[]}}],"position":{"start":{"line":106,"column":1,"offset":7892},"end":{"line":106,"column":293,"offset":8184},"indent":[]}},{"type":"listItem","loose":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Now, whenever an API finishes running (when all its implementing plugins have finished), we decrement ","position":{"start":{"line":107,"column":5,"offset":8189},"end":{"line":107,"column":107,"offset":8291},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">apisRunningByTraceId[traceId]</code>","position":{"start":{"line":107,"column":107,"offset":8291},"end":{"line":107,"column":138,"offset":8322},"indent":[]}},{"type":"text","value":". If the original API call included the ","position":{"start":{"line":107,"column":138,"offset":8322},"end":{"line":107,"column":178,"offset":8362},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">waitForCascadingActions</code>","position":{"start":{"line":107,"column":178,"offset":8362},"end":{"line":107,"column":203,"offset":8387},"indent":[]}},{"type":"text","value":" option, then we wait until ","position":{"start":{"line":107,"column":203,"offset":8387},"end":{"line":107,"column":231,"offset":8415},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">apisRunningByTraceId[traceId]</code>","position":{"start":{"line":107,"column":231,"offset":8415},"end":{"line":107,"column":262,"offset":8446},"indent":[]}},{"type":"text","value":" == 0 before resolving.","position":{"start":{"line":107,"column":262,"offset":8446},"end":{"line":107,"column":285,"offset":8469},"indent":[]}}],"position":{"start":{"line":107,"column":5,"offset":8189},"end":{"line":107,"column":285,"offset":8469},"indent":[]}}],"position":{"start":{"line":107,"column":1,"offset":8185},"end":{"line":107,"column":285,"offset":8469},"indent":[]}}],"position":{"start":{"line":92,"column":1,"offset":6638},"end":{"line":107,"column":285,"offset":8469},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":108,"column":1,"offset":8470}}}}